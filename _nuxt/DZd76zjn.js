import{d as ee,X as se,a0 as B,H,be as h,o as r,c as _,b as m,g as t,e as s,t as i,i as d,B as u,n as fe,f as x,C as L,K as be,p as te,A as ae,Y as we,x as ye,y as he,_ as oe,ai as ke,aa as Be,j as $e,ax as Me,I as Te,b9 as Ee,a as Ne,aM as Se,b3 as Ce,s as Z,bi as y,aq as Ae,as as Ie,l as Le,F as De,aU as I,a4 as Ue,aH as Oe,M as Re,U as Pe,ay as xe,bb as He,h as Ve}from"./7PQ9d4dP.js";import{_ as je}from"./BFbZvv9A.js";import"./UCCBr-NG.js";import"./D0WEjs_T.js";const V=f=>(ye("data-v-eb6f95e2"),f=f(),he(),f),ze={class:"message-order"},Fe=["innerHTML"],Ke=V(()=>s("div",{class:"tw-my-6 ng-divider"},null,-1)),qe={key:0,class:"tw-flex tw-flex-col tw-items-center tw-my-6"},Ge=["href"],Qe={class:"tw-mt-6 tw-mb-2"},We=V(()=>s("div",{class:"tw-my-6 ng-divider"},null,-1)),Xe={key:1,class:"tw-my-6"},Ye={class:"message-order-subtitle"},Je={class:"message-order-info"},Ze={class:"tw-flex tw-items-center tw-gap-3"},es={class:"tw-text-base"},ss={class:"tw-flex tw-items-center"},ts={class:"tw-text-base"},as={key:2,class:"tw-flex"},os={class:"tw-w-1/2 tw-pe-6"},ns={class:"message-order-subtitle"},is={class:"tw-mt-4 tw-text-base"},ls={class:"tw-w-1/2 tw-ps-6 tw-border-l tw-border-border-primary"},rs={class:"message-order-subtitle"},cs={class:"tw-mt-4 tw-text-base"},ds={class:"mt-8"},_s=V(()=>s("div",{class:"tw-my-6 ng-divider"},null,-1)),us={class:"message-order-footer"},ms=ee({__name:"OrderMessage",props:{item:{},checked:{type:Boolean}},setup(f){const p=f,D=se(),g=B(!1),$=H(()=>{var e;return p.item.type===h.tier_push||p.item.type===h.tier_modal?"/img/tierNotyBanner.png":((e=p.item.message)==null?void 0:e.banner)||p.item.message_default.banner||"/img/tierNotyBanner.png"}),M=e=>{be(e),g.value=!g.value,setTimeout(()=>{g.value=!g.value},1e3)};return(e,T)=>{var b,E,w,v,N,S;const k=te,U=ae,O=we;return r(),_("div",ze,[m(k,{src:t($),alt:"banner",class:"message-order-img"},null,8,["src"]),s("div",{class:"message-order-desc",innerHTML:((E=(b=e.item)==null?void 0:b.message)==null?void 0:E.description)||e.item.message_default.description},null,8,Fe),Ke,e.item.message.btn_link&&e.item.message.btn?(r(),_("div",qe,[s("a",{target:"_BLANK",href:e.item.message.btn_link},[m(U,{class:"tw-w-full","label-key":e.item.message.btn},null,8,["label-key"])],8,Ge),s("span",Qe,i(e.$t("or_copy_the_link_below"))+":",1),s("span",{class:"tw-text-text-brand",onClick:T[0]||(T[0]=j=>M(e.item.message.btn_link))},i(t(g)?e.$t("copied"):e.item.message.btn_link),1),We])):d("",!0),(w=e.item.message)!=null&&w.relation_data?(r(),_("div",Xe,[s("div",Ye,i(e.$t("order_details")),1),s("div",Je,[s("div",Ze,[(v=e.item.message.relation_data)!=null&&v.product_banner?(r(),u(k,{key:0,src:e.item.message.relation_data.product_banner,class:"tw-w-[50px] tw-h-[50px] tw-object-contain tw-rounded",alt:"banner"},null,8,["src"])):d("",!0),s("div",es,i(e.item.message.relation_data.product_name),1)]),s("div",ss,[s("span",ts,i(e.item.message.relation_data.product_points),1),m(k,{src:t(fe)("nuxPoint"),class:"tw-w-4 tw-h-4 tw-ms-2",alt:"currency"},null,8,["src"])])])])):d("",!0),(S=(N=e.item.message)==null?void 0:N.relation_data)!=null&&S.address?(r(),_("div",as,[s("div",os,[s("div",ns,i(e.$t("customer_information")),1),s("div",is,[s("p",null,i(e.item.message.relation_data.user_name),1),s("p",null,i(e.item.message.relation_data.user_phone),1)])]),s("div",ls,[s("div",rs,i(e.$t("delivery_adress")),1),s("div",cs,[s("p",null,i(e.item.message.relation_data.address.full_name),1),s("p",null,i(e.item.message.relation_data.address.street),1),s("p",null,i(e.item.message.relation_data.address.city)+", "+i(e.item.message.relation_data.address.zip_code),1),s("p",ds,i(e.item.message.relation_data.address.country),1)])])])):d("",!0),_s,s("div",us,[s("p",null,[x(i(e.$t("footer_messsage_part_1"))+" ",1),m(O,{class:"footer-link",to:t(D)({path:"/tickets/create"})},{default:L(()=>[x(i(e.$t("support")),1)]),_:1},8,["to"]),x(" "+i(e.$t("footer_messsage_part_2")),1)])])])}}}),ps=oe(ms,[["__scopeId","data-v-eb6f95e2"]]),gs={class:"message-date"},vs={class:"tw-flex tw-items-center tw-justify-between tw-mb-6"},fs={class:"message-title"},bs={class:"message-actions"},ws={class:"message-body"},ys={key:1},hs={class:"tw-my-6 tw-flex tw-flex-col tw-gap-2"},ks={key:0,class:"tw-text-3xl tw-font-bold"},Bs=["innerHTML"],$s={key:2,class:"tw-flex tw-items-center tw-justify-center"},Ms={key:1,class:"tw-flex tw-flex-col tw-items-center tw-gap-8"},Ts={class:"messageBonusTitle"},Es=ee({__name:"[id]",setup(f){const p=ke(),D=Be(),g=$e(),$=se(),M=Me(),e=Te(),T=Ee(),{fetchMessage:k,setUnread:U,deleteMessages:O,setIsUnreadUserMessages:b,activateMessageBonus:E}=T,{t:w}=Ne(),{$emitter:v}=Se(),{openModal:N}=e,{showActivateModal:S}=M,{setBreadcrumbs:j}=Ce(),{getBonusTypes:ne,isMultiBalance:ie,isMobile:le}=Z(g),{getActiveBonus:re}=Z(M),z={[y.UNREAD]:U,[y.DELETE]:O},R=B(!1),C=B(!1),P=B(p.params.id),a=B({}),ce=H(()=>{var l,o;return a.value.type===h.tier_push||a.value.type===h.tier_modal?"/img/tierNotyBanner.png":((o=(l=a.value)==null?void 0:l.message)==null?void 0:o.banner)||a.value.message_default.banner||"/img/tierNotyBanner.png"}),F=H(()=>{var l,o,c;return((o=(l=a.value)==null?void 0:l.message)==null?void 0:o.subject)||((c=a==null?void 0:a.value.message_default)==null?void 0:c.subject)}),de=()=>{var o,c,n;if(!((o=a.value)!=null&&o.bonus))return;ie.value||((c=a.value)==null?void 0:c.bonus.actions.includes(xe.PROMO_CODE))||re.value?(ue(),S((n=a.value)==null?void 0:n.bonus,He.MESSAGES)):_e()},_e=async()=>{var l,o;try{if(!((l=a.value)!=null&&l.bonus))throw new Error("No bonus");await E({id:(o=a.value)==null?void 0:o.bonus.id}),q()}catch(c){console.log("activateBonus MessagesAction",c)}},K=async l=>{if(l===y.DELETE){const c=await z[l]([+P.value]);b(c.unread_company_messages),C.value=!1,D.push($({path:"/messages"}));return}l===y.UNREAD&&(a.value.is_read=!1);const o=await z[l]([+P.value]);b(o.unread_company_messages)},q=async()=>{try{await G()}catch(l){console.log("confirmBonus /messages/id",l)}},G=async()=>{var l,o,c;try{R.value=!0;const n=await k(p.params.id);a.value=n,(l=n==null?void 0:n.message)!=null&&l.description?a.value.message.description=decodeURIComponent(escape(atob((o=n==null?void 0:n.message)==null?void 0:o.description))):a.value.message_default.description=decodeURIComponent(escape(atob((c=n==null?void 0:n.message_default)==null?void 0:c.description))),b(n.unread_company_messages)}catch(n){console.log(n)}finally{R.value=!1}},ue=()=>{v.on(I.BONUS_ACTIVATED,q),v.on(I.CLOSE_BONUS_MODAL,Q)},Q=()=>{v.off(I.BONUS_ACTIVATED),v.off(I.CLOSE_BONUS_MODAL)};return j([{label:w("messages"),path:$({path:"/messages"})},{label:`â„– ${P.value}`}]),Ae(async()=>{await G()},"$pL48QLkPtc"),Ie(),Le(()=>{Q()}),De({title:()=>F.value||"Messages"}),(l,o)=>{const c=Ve,n=ae,me=ps,pe=te,ge=je,ve=Ue;return r(),u(ve,{loading:t(R)},{default:L(()=>{var W,X,Y,J;return[t(a)?(r(),_("div",{key:0,class:Pe(["message",{"message--mobile":t(le)}])},[s("div",gs,i(t(Oe)(t(a).date)),1),s("div",vs,[s("h1",fs,i(t(F)),1),s("div",bs,[t(a).is_read?(r(),u(n,{key:0,"is-with-icon":"",class:"message-action","color-type":"transparent","icon-position":"right","label-key":"unread",onClick:o[0]||(o[0]=A=>K(t(y).UNREAD))},{default:L(()=>[m(c,{name:"message_unread",size:25})]),_:1})):d("",!0),m(n,{"is-with-icon":"",class:"message-action","color-type":"transparent","icon-position":"right","label-key":"delete",onClick:o[1]||(o[1]=A=>C.value=!0)},{default:L(()=>[m(c,{name:"delete",size:25})]),_:1})])]),s("div",ws,[t(a).type===t(h).order_messages?(r(),u(me,{key:0,item:t(a)},null,8,["item"])):(r(),_("div",ys,[s("div",null,[m(pe,{src:t(ce),alt:"banner",class:"message-img"},null,8,["src"])]),s("div",hs,[t(a).bonus?(r(),_("div",ks,i(t(a).bonus.name),1)):d("",!0),s("div",{innerHTML:((X=(W=t(a))==null?void 0:W.message)==null?void 0:X.description)||((J=(Y=t(a))==null?void 0:Y.message_default)==null?void 0:J.description)},null,8,Bs)]),t(a).type===t(h).agent_player_after_registration_modal?(r(),u(n,{key:0,"label-key":"go_to_profile",onClick:o[2]||(o[2]=A=>t(N)(t(Re).PROFILE_STATISTIC))})):d("",!0)])),t(a).bonus?(r(),_("div",$s,[t(a).bonus.is_activated?(r(),u(n,{key:0,"label-key":"bonus_has_been_activated","is-disabled":!0})):(r(),_("div",Ms,[s("span",Ts,i(t(w)("you_have_got_bonus"))+" "+i(t(w)(`${t(ne)[t(a).bonus.type]}_bonus`)),1),t(a).bonus.not_for_activation?d("",!0):(r(),u(n,{key:0,"label-key":"activate",onClick:de}))]))])):d("",!0)])],2)):d("",!0),t(C)?(r(),u(ge,{key:1,onConfirm:o[3]||(o[3]=A=>K(t(y).DELETE)),onClose:o[4]||(o[4]=A=>C.value=!1)})):d("",!0)]}),_:1},8,["loading"])}}}),Is=oe(Es,[["__scopeId","data-v-c1f17a36"]]);export{Is as default};
