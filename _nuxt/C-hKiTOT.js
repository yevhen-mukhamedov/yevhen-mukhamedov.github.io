import{_ as ee}from"./BMBJnSAB.js";import{_ as te}from"./B92FZ1g3.js";import{V as O,_ as M,i as j,j as L,o as l,c,X as t,t as h,b as m,a as d,d as z,aK as ae,n as x,$ as se,a7 as oe,W as le,br as ne,a2 as re,a1 as ie,Z as N,ac as G,ae as w,f as I,u as f,x as D,F as ce,r as ue,a5 as de,az as me,a6 as pe}from"./JoFQSik9.js";import{u as fe,a as he}from"./BM2BYuY2.js";import{_ as _e}from"./DJse-9-j.js";import{_ as ye}from"./sQNTZNBq.js";import{_ as ge}from"./Cel6GgYv.js";import{I as ve,A as ke}from"./CHDbCGUn.js";import{a as be}from"./56Y_7FHu.js";const $e=["for"],we={class:"input-container"},Ie={key:0,class:"input-placeholder"},Ve=["id","value","name","readonly","disabled","required","autocomplete"],Te={key:0,class:"input-suffix"},Re={class:"input-message"},Fe={key:0,class:"input-support-text"},Se={key:1,class:"ng-control-error-message"},qe=O({__name:"NgTextarea",props:{isLabelShown:{type:Boolean,default:!1},inputName:{default:""},labelKey:{default:""},isReadonly:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},placeholderKey:{default:""},isRequired:{type:Boolean,default:!1},isAutocomplete:{type:Boolean,default:!0},classes:{default:""},modelValue:{default:""},isValidatedSeparately:{type:Boolean,default:!1},validationRules:{default:null},supportingTextKey:{},suffixKey:{},resize:{default:"none"}},emits:["input","blur","focus","update:modelValue"],setup(B,{emit:C}){const{t:u}=M(),r=B,{value:V,errorMessage:y}=fe(()=>r.inputName,r.isValidatedSeparately?r.validationRules:null,{syncVModel:!0}),T=j(!1),E=L(()=>`
    ${r.classes}
    ${y.value?"ng-control-error":""}
    `),S=L(()=>r.isLabelShown&&r.labelKey),U=L(()=>r.isRequired?u(r.labelKey):`${u(r.labelKey)} (${u("optional")})`),g=L(()=>!r.isRequired&&!S.value?`${u(r.placeholderKey)} (${u("optional")})`:u(r.placeholderKey)),b=C,s=a=>{const n=a.target;b("update:modelValue",n.value),b("input",n.value)},q=a=>{const n=a.target;T.value=!0,b("focus",n.value)},v=a=>{const n=a.target;T.value=!1,b("blur",n.value)};return(a,n)=>(l(),c("div",{class:x([[t(E),{focus:t(T),active:a.modelValue,placeholder:a.placeholderKey,error:t(y),disabled:a.isDisabled}],"ng-control ng-textarea"])},[t(S)?(l(),c("label",{key:0,class:"ng-control-label",for:a.inputName},h(t(U)),9,$e)):m("",!0),d("div",{class:x([[{"ng-control-inner-icon-left":a.$slots.leftIcon,"ng-control-inner-icon-right":a.$slots.rightIcon}],"ng-control-inner"])},[z(a.$slots,"leftIcon"),d("div",we,[a.placeholderKey?(l(),c("div",Ie,h(t(g)),1)):m("",!0),d("textarea",{id:a.inputName,value:t(V),class:"ng-control-input",name:a.inputName,readonly:"isReadonly"in a?a.isReadonly:t(ae),disabled:a.isDisabled,required:a.isRequired,autocomplete:a.isAutocomplete?"on":"off",onInput:n[0]||(n[0]=k=>s(k)),onBlur:n[1]||(n[1]=k=>v(k)),onFocus:n[2]||(n[2]=k=>q(k))},null,40,Ve)]),a.suffixKey?(l(),c("div",Te,h(t(u)(a.suffixKey)),1)):m("",!0),z(a.$slots,"rightIcon")],2),d("div",Re,[a.supportingTextKey&&!t(y)?(l(),c("span",Fe,h(t(u)(a.supportingTextKey)),1)):m("",!0),t(y)?(l(),c("span",Se,h(t(u)(t(y))),1)):m("",!0)])],2))}}),Ke={class:"form-actions"},Le={class:"form-files-button"},Ne={class:"tw-relative"},je={class:"tw-text-text-tertiary tw-text-base"},Be={key:4,class:"tw-mt-4 tw-flex tw-items-center tw-flex-wrap tw-gap-4"},Ce=["alt","src"],Ee={class:"fg-info-12-thin file-name"},Ue={key:5,class:"create-actions"},De={key:1,class:"guest-success"},xe={class:"guest-success-title"},Ae={class:"guest-success-desc"},ze={class:"guest-success-desc"},Ge=O({__name:"TicketForm",props:{ticketId:{}},setup(B){const{t:C}=M(),u=se(),r=oe(),V=le(),y=B,{createTicket:T,createGuestTicket:E,createReplyTicket:S}=ne(),U=re(),{isLoggedIn:g}=ie(U),b=r.path===N.contact_us_create,s=j({name:"",email:"",subject:"",message:"",attachments:[]}),q=j(!1),v=j({}),a=()=>{s.value={name:"",email:"",subject:"",message:"",attachments:[]}},n={validationSchema:G({subject:w().required(),message:w().required()})},k={validationSchema:G({subject:w().required(),message:w().required(),name:w().required(),email:w().required().matches(be,C("email_error"))})},{handleSubmit:P,resetForm:A}=he(g.value?n:k),W=()=>{try{const e=new FormData;e.append("content",s.value.message),s.value.attachments.forEach((o,p)=>{e.append(`attachments[${p}]`,o)}),S(y.ticketId,e),A(),a()}catch(e){console.log(e)}},X=()=>{u.push(V(N.contact_us))},Z=P(async()=>{try{const e=new FormData;if(e.append("title",s.value.subject),e.append("content",s.value.message),s.value.attachments.forEach((o,p)=>{e.append(`attachments[${p}]`,o)}),g.value||(e.append("reply_name",s.value.name),e.append("reply_mail",s.value.email)),g.value){const{data:o}=await T(e);u.push({path:V(`${N.contact_us}/${o.ticket_id}`),query:{new:"true"}})}else await E(e),q.value=!0;v.value={},a()}catch(e){console.log(e),e&&typeof e=="object"?v.value=e:v.value={msg:e}}finally{A()}}),Y=e=>{var $;let o=0;const p=($=e.target)==null?void 0:$.files;if(p)for(let R=0;R<p.length;R++){const _=p[R];o+=_.size,ve.test(_.type)&&(_.src=URL.createObjectURL(_),_.onload=function(){URL.revokeObjectURL(_.src)})}o>ke||(p&&(s.value.attachments=[...s.value.attachments,...Array.from(p)]),e.target.value="")},H=e=>{s.value.attachments=s.value.attachments.filter(o=>o.name!==e.name)};return(e,o)=>{const p=ee,$=te,R=qe,_=_e,K=de,F=ye,J=ge,Q=me;return t(q)?(l(),c("div",De,[f(K,{name:"support",width:48,height:48,class:"tw-mb-5 tw-text-input-fg"}),d("h2",xe,h(e.$t("thanks_in_advance")),1),d("p",Ae,h(e.$t("we_appreciate_you")),1),d("p",ze,h(e.$t("while_we_do_our_best")),1),f(Q,{to:t(V)(t(N).main_home),class:"guest-success-btn"},{default:D(()=>[f(F,{"label-key":"close"})]),_:1},8,["to"])])):(l(),c("form",{key:0,class:x(["ticket-create-form",{"single-ticket-form":!b}])},[Object.keys(t(v)).length?(l(),I(p,{key:0,error:t(v),type:"content",class:"tw-mb-4"},null,8,["error"])):m("",!0),t(g)?m("",!0):(l(),I($,{key:1,modelValue:t(s).name,"onUpdate:modelValue":o[0]||(o[0]=i=>t(s).name=i),class:"tw-mb-3","is-required":"","placeholder-text":e.$t("name"),"input-name":"name","is-validated-separately":!1},null,8,["modelValue","placeholder-text"])),t(g)?m("",!0):(l(),I($,{key:2,modelValue:t(s).email,"onUpdate:modelValue":o[1]||(o[1]=i=>t(s).email=i),"is-required":"",class:"tw-mb-3","is-requried":!0,"placeholder-text":e.$t("email"),"input-name":"email","is-validated-separately":!1},null,8,["modelValue","placeholder-text"])),e.ticketId?m("",!0):(l(),I($,{key:3,modelValue:t(s).subject,"onUpdate:modelValue":o[2]||(o[2]=i=>t(s).subject=i),"is-validated-separately":!1,"is-required":"","placeholder-text":e.$t("subject"),"input-name":"subject",class:"tw-mb-3"},null,8,["modelValue","placeholder-text"])),f(R,{modelValue:t(s).message,"onUpdate:modelValue":o[3]||(o[3]=i=>t(s).message=i),class:"tw-h-40 tw-mb-3","placeholder-key":"message","input-name":"message","is-validated-separately":!1},null,8,["modelValue"]),d("div",Ke,[d("div",Le,[d("div",Ne,[f(_,{class:"form-file-input","is-multiple":!0,"input-name":"files",onInput:Y}),f(F,{"label-key":"add_files","color-type":"secondary",class:"form-file-button","icon-position":"left","is-with-icon":""},{default:D(()=>[f(K,{name:"clip",class:"tw-text-text-secondary",width:25,height:25})]),_:1})]),d("div",je,h(e.$t("you_can_choose_several")),1)]),e.ticketId?(l(),I(F,{key:0,"label-key":"send","color-type":"primary",class:"form-reply-ticket",onClick:W})):m("",!0)]),t(s).attachments.length?(l(),c("div",Be,[(l(!0),c(ce,null,ue(t(s).attachments,i=>(l(),c("div",{key:i.name,class:"ticket-create-form-file"},[f(J,{class:"delete-button","label-key":"delete","color-type":"red",onClick:Oe=>H(i)},{default:D(()=>[f(K,{name:"contact-us-remove-file",color:"white",width:15,height:15})]),_:2},1032,["onClick"]),i.src?(l(),c("img",{key:0,alt:i.name,width:"60",height:"60",src:i.src},null,8,Ce)):(l(),I(K,{key:1,name:"contact-us-file",color:"#63657F",width:60,height:60})),d("div",Ee,h(i.name),1)]))),128))])):m("",!0),e.ticketId?m("",!0):(l(),c("div",Ue,[f(F,{"label-key":"back","color-type":"secondary",onClick:X}),f(F,{"label-key":"submit_ticket","color-type":"primary",onClick:t(Z)},null,8,["onClick"])]))],2))}}}),et=pe(Ge,[["__scopeId","data-v-6dd6efa5"]]);export{et as _};
