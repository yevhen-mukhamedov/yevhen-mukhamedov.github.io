import{_ as oe,d as se,F as te}from"./BQWyzQZp.js";import{_ as ne}from"./DqC-nx6a.js";import{c as le,_ as re}from"./D4aeT6U_.js";import{_ as ie}from"./C3H6epDl.js";import{d as ue,a as de,a7 as me,j as pe,aa as ce,H as w,b7 as g,a0 as p,w as _e,o as l,B as r,C as fe,e as B,g as a,c as q,a1 as $,aE as he,i as d,b as v,$ as we,A as ge,_ as ye}from"./7PQ9d4dP.js";import{_ as ve}from"./sLJFuQGL.js";import{u as Le}from"./DD170oM2.js";import"./D0WEjs_T.js";import"./CJGqVaXH.js";import"./CHcNArxE.js";import"./BjfPoI8C.js";var L=(e=>(e[e.DONE=200]="DONE",e[e.TOO_MANY_INVALID_LOGIN_ATTEMPTS=211]="TOO_MANY_INVALID_LOGIN_ATTEMPTS",e[e.WRONG_LOGIN_PASSWORD=212]="WRONG_LOGIN_PASSWORD",e[e.PROBLEM_WITH_CAPTCHA=213]="PROBLEM_WITH_CAPTCHA",e[e.UNAUTHORIZED=214]="UNAUTHORIZED",e[e.WRONG_PASSWORD=215]="WRONG_PASSWORD",e[e.NEED_TWO_FA_CODE=216]="NEED_TWO_FA_CODE",e[e.WRONG_TWO_FA_CODE=217]="WRONG_TWO_FA_CODE",e[e.ALREADY_ENABLED=218]="ALREADY_ENABLED",e[e.SOCIAL_AUTH_ERROR=219]="SOCIAL_AUTH_ERROR",e[e.VALIDATION_FAILED=220]="VALIDATION_FAILED",e[e.SOCIAL_AUTH_EMAIL_EXIST=221]="SOCIAL_AUTH_EMAIL_EXIST",e[e.BLOCK_AFTER=222]="BLOCK_AFTER",e[e.WRONG_CODE=223]="WRONG_CODE",e[e.WRONG_TOKEN=224]="WRONG_TOKEN",e[e.NEED_PASSWORD_AGAIN=225]="NEED_PASSWORD_AGAIN",e[e.SOCIAL_NOT_SET_UP=226]="SOCIAL_NOT_SET_UP",e))(L||{});const Ve={class:"login-form-container"},ke={class:"tw-flex tw-gap-1 tw-justify-between"},Fe=6,Ne=ue({__name:"LoginForm",setup(e){const{t:i}=de(),S=me(),K=pe(),Y=ce(),{getLoginType:c,getCountryCode:y,globalData:_,isShowAuthSocial:j,shiftOpenedModals:D}=K,{authorize:X,setForgotPasswordModal:z,setAuthModal:J}=S,V=w(()=>g[c].includes("phone")),k=w(()=>g[c].includes("username")),Q=w(()=>g[c].includes("email")),A=[{inputName:"email",hasUsername:!0,required:!V.value},{inputName:"phone",required:!1},{inputName:"password",required:!0},{inputName:"password_confirmation",errorText:i("passwords_should_match"),required:!0}],C=new Map(le.map(o=>[o.iso2,o])),E=w(()=>{var h,m;const o=((m=(h=_==null?void 0:_.reg_form_settings)==null?void 0:h.country_code)==null?void 0:m.default)||(y==null?void 0:y.toLowerCase()),s=C.get(o)??null;return s?s==null?void 0:s.phone_code:""}),u=p([]),F=p(!1),N=p(!1),f=p(!1),t=p({user_id:"",email:"",username:"",password:"",password_again:"",phone:"",phone_code:E.value,remember_me:!1,code:""}),W=Le(A),U=()=>{const o=g[c].find(s=>t.value[s]);return t.value[o]},H=o=>{(o==null?void 0:o.length)===Fe&&b()},T=({phoneCode:o,phone:s})=>{t.value.phone=o+s,t.value.phone_code=o},b=async()=>{t.value.username=t.value.email,t.value.user_id=U(),u.value=[],f.value=!0;try{const o=!!await W.validate(t.value);o&&(u.value=[],await X(t.value),f.value=!o,P(),Y.replace({query:{}}))}catch(o){const{error_code:s}=o;u.value.push(o),F.value=s===L.NEED_TWO_FA_CODE,N.value=s===L.NEED_PASSWORD_AGAIN}finally{f.value=!1}},I=()=>{P(),z(!0)},Z=o=>{u.value=[],u.value.push(o)},P=()=>{J("hidden"),D()};return _e(()=>t.value.code,o=>H(o)),(o,s)=>{const h=oe,m=ne,O=re,G=se,R=ie,x=ge,ee=ve,ae=te;return l(),r(ae,{class:"tw-px-8 mobile:tw-px-6","validation-schema":a(W),onSubmit:b},{default:fe(()=>{var M;return[B("div",Ve,[Object.keys(a(u)).length?(l(!0),q($,{key:0},he(a(u),n=>(l(),r(h,{key:n.error_code,error:n,validation:"",type:"message"},null,8,["error"]))),128)):d("",!0),a(F)?(l(),r(m,{key:2,modelValue:a(t).code,"onUpdate:modelValue":s[5]||(s[5]=n=>a(t).code=n),"placeholder-text":a(i)("code"),"is-required":"","input-name":"code","input-type":"text"},null,8,["modelValue","placeholder-text"])):(l(),q($,{key:1},[a(k)||a(Q)?(l(),r(m,{key:0,modelValue:a(t).email,"onUpdate:modelValue":s[0]||(s[0]=n=>a(t).email=n),type:"email","input-name":"email","is-required":"","is-validated-separately":!0,"placeholder-text":a(k)?a(i)("username_or_email"):a(i)("email")},null,8,["modelValue","placeholder-text"])):d("",!0),a(V)?(l(),r(O,{key:1,modelValue:a(t).phone,"onUpdate:modelValue":s[1]||(s[1]=n=>a(t).phone=n),type:"text","placeholder-key":a(i)("phone"),"input-name":"phone","is-validated-separately":!0,"default-code":a(t).phone_code,onChange:T},null,8,["modelValue","placeholder-key","default-code"])):d("",!0),v(G,{modelValue:a(t).password,"onUpdate:modelValue":s[2]||(s[2]=n=>a(t).password=n),"is-required":!0,classes:"ng-auth-input","placeholder-key":"password","input-name":"password","is-validated-separately":!1},null,8,["modelValue"]),a(N)?(l(),r(G,{key:2,modelValue:a(t).password_again,"onUpdate:modelValue":s[3]||(s[3]=n=>a(t).password_again=n),"is-required":!0,classes:"ng-auth-input","placeholder-key":"password_confirmation","input-name":"password_confirmation","is-validated-separately":!0},null,8,["modelValue"])):d("",!0),B("div",ke,[(M=a(_))!=null&&M.remember_me?(l(),r(R,{key:0,modelValue:a(t).remember_me,"onUpdate:modelValue":s[4]||(s[4]=n=>a(t).remember_me=n),"input-name":"remember_me",class:"tw-w-max","is-label-shown":"","is-label-left":"",type:a(we).check,"label-key":"remember_me"},null,8,["modelValue","type"])):d("",!0),v(x,{"color-type":"link",label:`${a(i)("forgot_password")}?`,class:"link-forgot-password",onClick:I},null,8,["label"])])],64)),v(x,{class:"tw-w-full","color-type":"primary",type:"submit","label-key":a(i)("sign_in"),"is-disabled":a(f)},null,8,["label-key","is-disabled"])]),a(j)?(l(),r(ee,{key:0,class:"ng-flex-center tw-py-8",onHandleError:Z})):d("",!0)]}),_:1},8,["validation-schema"])}}}),Ye=ye(Ne,[["__scopeId","data-v-794d2dbd"]]);export{Ye as default};
