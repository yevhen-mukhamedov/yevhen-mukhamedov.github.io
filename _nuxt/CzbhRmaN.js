import{_ as Ve,d as Se,b as Ce,e as Ie,F as De}from"./BQWyzQZp.js";import{_ as qe}from"./CXUEa_s4.js";import{d as Ue,a as $e,aa as xe,j as Ae,s as G,ax as Fe,H as I,a0 as D,a7 as H,w as Te,k as Me,o as u,B as c,C as h,e as i,g as n,i as m,b as q,t as y,$ as Ee,bl as W,z as Pe,h as Be,V as Re,A as Le,b7 as je,_ as ze}from"./7PQ9d4dP.js";import{_ as Oe}from"./DqC-nx6a.js";import{c as J,_ as Ge}from"./D4aeT6U_.js";import{_ as He}from"./C3H6epDl.js";import{_ as We}from"./sLJFuQGL.js";import{u as Je}from"./DD170oM2.js";import{u as Ye}from"./UCCBr-NG.js";import"./D0WEjs_T.js";import"./CJGqVaXH.js";import"./CHcNArxE.js";import"./BjfPoI8C.js";const Ke={class:"registration-form-container"},Qe={class:"selected-option"},Xe={class:"simple-option"},Ze={class:"simple-option-value"},ea={class:"simple-option-label"},aa={class:"simple-option-name"},ta={class:"simple-option"},oa={class:"simple-option-value"},sa={class:"selected-option"},na={class:"simple-option"},la={class:"simple-option-value"},ra={class:"simple-option-label"},ia={class:"simple-option-name"},da={class:"simple-option"},ua={class:"simple-option-value"},ca=Ue({__name:"RegistrationForm",setup(ma){var E,P,B;const{t:v}=$e(),Y=xe(),b=Ae(),{getRegFormSettings:U,getRegFormTermsAndConditionsPageUrl:K,getCountryCode:$,globalData:p,getAnalyticsEvents:Q,isShowAuthSocial:X}=G(b),{getLoginType:Z,shiftOpenedModals:ee}=b,ae=new Map(J.map(e=>[e.iso2,e])),x=new Map(p.value.countries.map(e=>[e.code,e])),te=e=>{let s=!1;return(e.label===W.CPF||e.label===W.CUIT_CUIL)&&(s=!0),s},oe=U.value?{...U.value,password_confirmation:{required:!0,default:""}}:{},A=Object.entries(oe).map(([e,s])=>{var g,k,w,V,S,C;let l="NgInputText",r=v("error"),d="text";switch(e){case"bank_name":r=v("bank_name_should_be_valid"),l="NgSingleSelector";break;case"email":r=v("email_should_be_valid"),d="email";break;case"password":l="NgInputPassword";break;case"phone":l="NgPhoneNumber";break;case"password_confirmation":r=v("passwords_should_match"),l="NgInputPassword";break;case"birthday":l="NgDatepicker";break;case"country_code":l="NgCountrySelector";break;case"currency":l="NgCurrencySelector";break;case"bank_account_number":l="NgInputNumber";break;case"personal_number":l="NgInputText";break}const _=s;return{inputName:e,label:(k=(g=b.getFieldValidations)==null?void 0:g[e])==null?void 0:k.label,key:e,inputType:d,errorText:r,inputComponent:l,required:_.required,default:_.default,options:_.options,validate:(V=(w=b.getFieldValidations)==null?void 0:w[e])==null?void 0:V.validate,mask:(C=(S=b.getFieldValidations)==null?void 0:S[e])==null?void 0:C.mask}}),se=Fe(),{setWelcomeBonusID:ne}=se,F=Je(A),{googleAnalytic:T}=Ye(),le=I(()=>{var l,r,d;const e=((r=(l=p.value.reg_form_settings)==null?void 0:l.country_code)==null?void 0:r.default)||((d=$.value)==null?void 0:d.toLowerCase()),s=ae.get(e)??null;return s?s==null?void 0:s.phone_code:""}),M=I(()=>{var l,r,d;const e=((r=(l=p.value.reg_form_settings)==null?void 0:l.country_code)==null?void 0:r.default)||((d=$.value)==null?void 0:d.toLowerCase());return x.get(e)??null??null}),o=D({want_join_membership:!1,agreement:!1,bank_account_number:"",account_holder_name:"",bank_name:"",name:"",phone_code:le.value,surname:"",email:"",birthday:"",telegram:"",country_code:((E=M.value)==null?void 0:E.code.toUpperCase())??"",city:"",currency:((B=(P=p.value)==null?void 0:P.currencies[0])==null?void 0:B.code)??"",address:"",zip_code:"",player_code:"",phone:"",username:"",affiliate_system_code:"",affiliate_system_token:"",password:"",agent_ref:!1}),re=I({get:()=>{var e,s;return x.get((s=(e=o.value)==null?void 0:e.country_code)==null?void 0:s.toLowerCase())??null},set:e=>{o.value={...o.value,country_code:(e==null?void 0:e.code.toUpperCase())??""}}}),f=D({}),{signUp:ie,authorize:de,setAuthModal:ue}=H(),{getAuthError:ce}=G(H()),N=D(!1),me=()=>{const e=window.localStorage.getItem("affiliateData");return e?JSON.parse(e):null},pe=()=>{const e=me();e&&Object.keys(e).forEach(s=>{s==="cxd"&&(o.value.affiliate_system_token=e[s]),s==="affid"&&(o.value.affiliate_system_code=e[s]),o.value[s]=e[s]})},_e=()=>{window.localStorage.removeItem("affiliateData")},fe=()=>{const e=je[Z].find(s=>o.value[s]);return o.value[e]},ge=()=>{var e;!T.value||!((e=Q.value)!=null&&e.registration_front)||T.value.emitEvent("registration_button")},he=async()=>{var e;N.value=!0,f.value={};try{const s=!!await F.validate(o.value);if(s){o.value.phone===o.value.phone_code&&(o.value.phone="");const l=Pe("_ga");o.value.affid&&o.value.cxd&&(delete o.value.affid,delete o.value.cxd);const{data:{register_bonus:r}}=await ie({...o.value,_ga:l.value,country_code:(e=re.value)==null?void 0:e.code.toLowerCase()}),_={user_id:fe()||o.value.email,password:o.value.password};o.value.phone&&(_.phone=o.value.phone,_.phone_code=o.value.phone_code);const g=await de(_);console.log("signInResponse",g),ue("hidden"),ee(),ne(r),N.value=!s,_e(),Y.replace({query:{}})}}catch(s){s&&typeof s=="object"&&(f.value=s)}finally{N.value=!1}},ye=({phoneCode:e,phone:s})=>{o.value.phone=s||"",o.value.phone_code=e},ve=(()=>{const s=new Date,l=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0");return`${l-18}-${r}-${d}`})(),be=e=>{f.value=[],f.value.push(e)};return Te(()=>ce.value,e=>{e&&(f.value=e)},{immediate:!0}),Me(()=>{pe()}),(e,s)=>{const l=Ve,r=qe,d=Be,_=Se,g=Oe,k=Ce,w=Ge,V=Ie,S=Re,C=He,Ne=Le,ke=We,we=De;return u(),c(we,{class:"registration-form","validation-schema":n(F),onSubmit:he},{default:h(()=>[i("div",Ke,[Object.keys(n(f)).length?(u(),c(l,{key:0,error:n(f),validation:"",type:"message"},null,8,["error"])):m("",!0),q(S,{list:n(A),"key-name":"transformed-form-field",container:!1},{item:h(({item:a})=>{var R,L,j,z,O;return[i("div",null,[a.inputComponent==="NgSingleSelector"?(u(),c(r,{key:0,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,"displayed-option":"label","returned-option":"id","additional-label":e.$t("bank_name"),placeholder:e.$t("bank_name"),"is-additional-label":!0,"item-list":a.options,"input-name":a.inputName,"is-validated-separately":!0,"is-required":a.required},null,8,["modelValue","onUpdate:modelValue","additional-label","placeholder","item-list","input-name","is-required"])):m("",!0),a.inputComponent==="NgCurrencySelector"?(u(),c(r,{key:1,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,"default-option":n(p).currencies[0],"returned-option":"code","class-list":"country-selector","item-list":n(p).currencies,"input-name":a.inputName,"is-required":a.required,"open-direction":"bottom"},{"selected-option":h(({props:t})=>[i("div",Qe,[i("div",Xe,[i("div",Ze,[i("span",ea,y(e.$t("currency")),1),i("span",aa,y(t.code),1)])])])]),option:h(({props:t})=>[i("div",ta,[i("span",oa,y(t.code),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","default-option","item-list","input-name","is-required"])):m("",!0),a.inputComponent==="NgCountrySelector"?(u(),c(r,{key:2,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,"default-option":n(M),"returned-option":(L=(R=n(p))==null?void 0:R.countries)!=null&&L.length?"code":"iso2","class-list":"country-selector","item-list":(z=(j=n(p))==null?void 0:j.countries)!=null&&z.length?(O=n(p))==null?void 0:O.countries:n(J),"input-name":a.inputName,"is-required":a.required,placeholder:e.$t("country"),"additional-label":e.$t("country"),"open-direction":"bottom"},{"selected-option":h(({props:t})=>[i("div",sa,[i("div",na,[t!=null&&t.code||t!=null&&t.iso2?(u(),c(d,{key:0,"is-init-color":!0,name:(t==null?void 0:t.code)||t.iso2,size:24,folder:"flags",class:"tw-rounded-full tw-overflow-hidden"},null,8,["name"])):m("",!0),i("div",la,[i("span",ra,y(e.$t("country")),1),i("span",ia,y(t.name),1)])])])]),option:h(({props:t})=>[i("div",da,[t!=null&&t.code||t!=null&&t.iso2?(u(),c(d,{key:0,"is-init-color":!0,name:(t==null?void 0:t.code)||(t==null?void 0:t.iso2),size:24,folder:"flags",class:"tw-rounded-full tw-overflow-hidden"},null,8,["name"])):m("",!0),i("span",ua,y(t.name),1)])]),_:2},1032,["modelValue","onUpdate:modelValue","default-option","returned-option","item-list","input-name","is-required","placeholder","additional-label"])):m("",!0),a.inputComponent==="NgInputPassword"?(u(),c(_,{key:3,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,classes:"ng-auth-input","placeholder-key":a.inputName,"input-name":a.inputName,"is-validated-separately":!0,"is-required":a.required},null,8,["modelValue","onUpdate:modelValue","placeholder-key","input-name","is-required"])):m("",!0),a.inputComponent==="NgInputText"?(u(),c(g,{key:4,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,type:a.inputType,"placeholder-text":e.$t(a.label||a.inputName),"input-name":a.inputName,"is-validated-separately":!0,"is-required":a.required,mask:a==null?void 0:a.mask,"is-success-icon":te(a)},null,8,["modelValue","onUpdate:modelValue","type","placeholder-text","input-name","is-required","mask","is-success-icon"])):m("",!0),a.inputComponent==="NgInputNumber"?(u(),c(k,{key:5,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,"placeholder-key":a.inputName,"input-name":a.inputName,"is-required":a.required,"is-validated-separately":!0},null,8,["modelValue","onUpdate:modelValue","placeholder-key","input-name","is-required"])):m("",!0),a.inputComponent==="NgPhoneNumber"?(u(),c(w,{key:6,type:a.inputType,"placeholder-text":e.$t(a.inputName),"input-name":a.inputName,"is-validated-separately":!0,"default-code":n(o).phone_code,"is-required":a.required,onChange:ye},null,8,["type","placeholder-text","input-name","default-code","is-required"])):m("",!0),a.inputComponent==="NgDatepicker"?(u(),c(V,{key:7,modelValue:n(o)[a.inputName],"onUpdate:modelValue":t=>n(o)[a.inputName]=t,type:a.inputType,"label-text":a.inputName,"input-name":a.inputName,"is-validated-separately":!0,"is-required":a.required,"start-date":n(ve),"input-type":"text","model-type":"yyyy-MM-dd",format:"yyyy-MM-dd"},null,8,["modelValue","onUpdate:modelValue","type","label-text","input-name","is-required","start-date"])):m("",!0)])]}),_:1},8,["list"]),q(C,{modelValue:n(o).agreement,"onUpdate:modelValue":s[0]||(s[0]=a=>n(o).agreement=a),class:"tw-w-max","label-key":"i_agree_with","is-label-shown":"","is-label-left":"",type:n(Ee).check,"label-link":{url:n(K),label:"terms_and_conditions",important:!0}},null,8,["modelValue","type","label-link"]),q(Ne,{classes:"tw-w-full tw-mt-6 tw-flex-shrink-0","color-type":"primary",type:"submit","label-key":n(v)("sign_up"),"is-disabled":n(N)||!n(o).agreement,onClick:ge},null,8,["label-key","is-disabled"]),n(X)?(u(),c(ke,{key:1,class:"ng-flex-center tw-py-8",onHandleError:be})):m("",!0)])]),_:1},8,["validation-schema"])}}}),Ia=ze(ca,[["__scopeId","data-v-8bb08fb0"]]);export{Ia as default};
