import{V as K,W,i as h,j as Q,ay as b,o as r,c,a as e,X as t,u as k,t as o,b as l,K as R,x as A,aj as me,az as _e,ah as ue,ai as pe,a6 as X,a7 as ge,$ as ve,a0 as fe,ak as we,aA as be,aB as ye,_ as he,a1 as G,aC as w,l as ke,f as p,a9 as C,aa as Be,aD as $e,aE as Me,n as Ee,aF as Te,aG as Ne,a5 as Se}from"./JoFQSik9.js";import{_ as q}from"./sQNTZNBq.js";import{g as Ce}from"./BZw8aVXh.js";import{_ as Ae}from"./Qsi9eMhV.js";import{_ as Le}from"./Cf_ozb67.js";import{u as De}from"./CkHyjaJP.js";import{u as Ie}from"./CXetEtI4.js";import{u as Oe}from"./CrHKx1Rg.js";import"./Bcnv4IFf.js";import"./D8aEg3BZ.js";const P=g=>(ue("data-v-90bbc1c8"),g=g(),pe(),g),Ue={class:"message-order"},Re=["src"],Pe=["innerHTML"],Ve=P(()=>e("div",{class:"tw-my-6 ng-divider"},null,-1)),xe={key:0,class:"tw-flex tw-flex-col tw-items-center tw-my-6"},je=["href"],ze={class:"tw-mt-6 tw-mb-2"},He=P(()=>e("div",{class:"tw-my-6 ng-divider"},null,-1)),Fe={key:1,class:"tw-my-6"},Ge={class:"message-order-subtitle"},Ke={class:"message-order-info"},We={class:"tw-flex tw-items-center tw-gap-3"},Qe=["src"],Xe={class:"tw-text-base"},qe={class:"tw-flex tw-items-center"},Je={class:"tw-text-base"},Ye=["src"],Ze={key:2,class:"tw-flex"},es={class:"tw-w-1/2 tw-pe-6"},ss={class:"message-order-subtitle"},ts={class:"tw-mt-4 tw-text-base"},as={class:"tw-w-1/2 tw-ps-6 tw-border-l tw-border-border-primary"},os={class:"message-order-subtitle"},ns={class:"tw-mt-4 tw-text-base"},is={class:"mt-8"},rs=P(()=>e("div",{class:"tw-my-6 ng-divider"},null,-1)),ls={class:"message-order-footer"},cs=K({__name:"OrderMessage",props:{item:{},checked:{type:Boolean}},setup(g){const _=g,L=W(),u=h(!1),B=Q(()=>{var s;return _.item.type===b.tier_push||_.item.type===b.tier_modal?"/img/tierNotyBanner.png":((s=_.item.message)==null?void 0:s.banner)||_.item.message_default.banner||"/img/tierNotyBanner.png"}),$=s=>{me(s),u.value=!u.value,setTimeout(()=>{u.value=!u.value},1e3)};return(s,M)=>{var E,v,T,f;const D=q,I=_e;return r(),c("div",Ue,[e("img",{src:t(B),alt:"banner",class:"message-order-img"},null,8,Re),e("div",{class:"message-order-desc",innerHTML:s.item.message.description},null,8,Pe),Ve,s.item.message.btn_link&&s.item.message.btn?(r(),c("div",xe,[e("a",{target:"_BLANK",href:s.item.message.btn_link},[k(D,{class:"tw-w-full","label-key":s.item.message.btn},null,8,["label-key"])],8,je),e("span",ze,o(s.$t("or_copy_the_link_below"))+":",1),e("span",{class:"tw-text-text-brand",onClick:M[0]||(M[0]=y=>$(s.item.message.btn_link))},o(t(u)?s.$t("copied"):s.item.message.btn_link),1),He])):l("",!0),(E=s.item.message)!=null&&E.relation_data?(r(),c("div",Fe,[e("div",Ge,o(s.$t("order_details")),1),e("div",Ke,[e("div",We,[(v=s.item.message.relation_data)!=null&&v.product_banner?(r(),c("img",{key:0,src:s.item.message.relation_data.product_banner,class:"tw-w-[50px] tw-h-[50px] tw-object-contain tw-rounded",alt:"banner"},null,8,Qe)):l("",!0),e("div",Xe,o(s.item.message.relation_data.product_name),1)]),e("div",qe,[e("span",Je,o(s.item.message.relation_data.product_points),1),e("img",{src:t(Ce)("nuxPoint"),class:"tw-w-4 tw-h-4 tw-ms-2",alt:"currency"},null,8,Ye)])])])):l("",!0),(f=(T=s.item.message)==null?void 0:T.relation_data)!=null&&f.address?(r(),c("div",Ze,[e("div",es,[e("div",ss,o(s.$t("customer_information")),1),e("div",ts,[e("p",null,o(s.item.message.relation_data.user_name),1),e("p",null,o(s.item.message.relation_data.user_phone),1)])]),e("div",as,[e("div",os,o(s.$t("delivery_adress")),1),e("div",ns,[e("p",null,o(s.item.message.relation_data.address.full_name),1),e("p",null,o(s.item.message.relation_data.address.street),1),e("p",null,o(s.item.message.relation_data.address.city)+", "+o(s.item.message.relation_data.address.zip_code),1),e("p",is,o(s.item.message.relation_data.address.country),1)])])])):l("",!0),rs,e("div",ls,[e("p",null,[R(o(s.$t("footer_messsage_part_1"))+" ",1),k(I,{class:"footer-link",to:t(L)({path:"/tickets/create"})},{default:A(()=>[R(o(s.$t("support")),1)]),_:1},8,["to"]),R(" "+o(s.$t("footer_messsage_part_2")),1)])])])}}}),ds=X(cs,[["__scopeId","data-v-90bbc1c8"]]),ms={class:"message-date"},_s={class:"tw-flex tw-items-center tw-justify-between tw-mb-6"},us={class:"message-title"},ps={class:"message-actions"},gs={class:"message-body"},vs={key:1},fs=["src"],ws={class:"tw-my-6 tw-flex tw-flex-col tw-gap-2"},bs={key:0,class:"tw-text-3xl tw-font-bold"},ys=["innerHTML"],hs={key:2,class:"tw-flex tw-items-center tw-justify-center"},ks={key:1,class:"tw-flex tw-flex-col tw-items-center tw-gap-8"},Bs={class:"messageBonusTitle"},$s=K({__name:"[id]",setup(g){const _=ge(),L=ve(),u=fe(),B=W(),$=we(),s=be(),M=ye(),{fetchMessage:D,setUnread:I,deleteMessages:E,setIsUnreadUserMessages:v,activateMessageBonus:T}=M,{t:f}=he(),{$emitter:y}=Be(),{openModal:J}=s,{showActivateModal:Y}=$,{setBreadcrumbs:Z}=De(),{getBonusTypes:ee,isMultiBalance:se,isMobile:te}=G(u),{getActiveBonus:ae}=G($),V={[w.UNREAD]:I,[w.DELETE]:E},O=h(!1),N=h(!1),U=h(_.params.id),a=h({}),oe=Q(()=>{var n;return a.value.type===b.tier_push||a.value.type===b.tier_modal?"/img/tierNotyBanner.png":((n=a.value.message)==null?void 0:n.banner)||a.value.message_default.banner||"/img/tierNotyBanner.png"}),ne=()=>{var i,d,m;if(!((i=a.value)!=null&&i.bonus))return;se.value||((d=a.value)==null?void 0:d.bonus.actions.includes(Te.PROMO_CODE))||ae.value?(re(),Y((m=a.value)==null?void 0:m.bonus,Ne.MESSAGES)):ie()},ie=async()=>{var n,i;try{if(!((n=a.value)!=null&&n.bonus))throw new Error("No bonus");await T({id:(i=a.value)==null?void 0:i.bonus.id}),j()}catch(d){console.log("activateBonus MessagesAction",d)}},x=async n=>{if(n===w.DELETE){const d=await V[n]([+U.value]);v(d.unread_company_messages),N.value=!1,L.push(B({path:"/messages"}));return}n===w.UNREAD&&(a.value.is_read=!1);const i=await V[n]([+U.value]);v(i.unread_company_messages)},j=async()=>{try{await z()}catch(n){console.log("confirmBonus /messages/id",n)}},z=async()=>{try{O.value=!0;const n=await D(_.params.id);a.value=n,a.value.message.description=decodeURIComponent(escape(atob(n.message.description))),v(n.unread_company_messages)}catch(n){console.log(n)}finally{O.value=!1}},re=()=>{y.on(C.BONUS_ACTIVATED,j),y.on(C.CLOSE_BONUS_MODAL,H)},H=()=>{y.off(C.BONUS_ACTIVATED),y.off(C.CLOSE_BONUS_MODAL)};return Z([{label:f("messages"),path:B({path:"/messages"})},{label:`â„– ${U.value}`}]),Ie(async()=>{await z()},"$pL48QLkPtc"),Oe(),ke(()=>{H()}),(n,i)=>{const d=Se,m=q,le=ds,ce=Ae,de=Le;return r(),p(de,{loading:t(O)},{default:A(()=>{var F;return[(F=t(a))!=null&&F.message?(r(),c("div",{key:0,class:Ee(["message",{"message--mobile":t(te)}])},[e("div",ms,o(t($e)(t(a).date)),1),e("div",_s,[e("h1",us,o(t(a).message.subject),1),e("div",ps,[t(a).is_read?(r(),p(m,{key:0,"is-with-icon":"",class:"message-action","color-type":"transparent","icon-position":"right","label-key":"unread",onClick:i[0]||(i[0]=S=>x(t(w).UNREAD))},{default:A(()=>[k(d,{name:"message_unread",size:25})]),_:1})):l("",!0),k(m,{"is-with-icon":"",class:"message-action","color-type":"transparent","icon-position":"right","label-key":"delete",onClick:i[1]||(i[1]=S=>N.value=!0)},{default:A(()=>[k(d,{name:"delete",size:25})]),_:1})])]),e("div",gs,[t(a).type===t(b).order_messages?(r(),p(le,{key:0,item:t(a)},null,8,["item"])):(r(),c("div",vs,[e("div",null,[e("img",{src:t(oe),alt:"banner",class:"message-img"},null,8,fs)]),e("div",ws,[t(a).bonus?(r(),c("div",bs,o(t(a).bonus.name),1)):l("",!0),e("div",{innerHTML:t(a).message.description},null,8,ys)]),t(a).type===t(b).agent_player_after_registration_modal?(r(),p(m,{key:0,"label-key":"go_to_profile",onClick:i[2]||(i[2]=S=>t(J)(t(Me).PROFILE_STATISTIC))})):l("",!0)])),t(a).bonus?(r(),c("div",hs,[t(a).bonus.is_activated?(r(),p(m,{key:0,"label-key":"bonus_has_been_activated","is-disabled":!0})):(r(),c("div",ks,[e("span",Bs,o(t(f)("you_have_got_bonus"))+" "+o(t(f)(`${t(ee)[t(a).bonus.type]}_bonus`)),1),t(a).bonus.not_for_activation?l("",!0):(r(),p(m,{key:0,"label-key":"activate",onClick:ne}))]))])):l("",!0)])],2)):l("",!0),t(N)?(r(),p(ce,{key:1,onConfirm:i[3]||(i[3]=S=>x(t(w).DELETE)),onClose:i[4]||(i[4]=S=>N.value=!1)})):l("",!0)]}),_:1},8,["loading"])}}}),Os=X($s,[["__scopeId","data-v-348a6473"]]);export{Os as default};
