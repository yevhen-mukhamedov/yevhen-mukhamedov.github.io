import{d as ft,a as bt,aT as gt,a0 as i,H as I,w as xt,k as ht,o as g,B as C,b as a,C as r,f as S,t as p,g as t,e,c as mt,T as kt,Q as $t,V as St,au as Ct,a4 as wt,_ as Nt,aa as Rt,X as Ft,m as Vt,s as ct,i as J,n as Dt,aV as jt,b6 as nt,ag as yt,bC as Ht,O as T,$ as Qt,p as Xt,h as Lt,A as Bt,x as Yt,y as Jt,F as Kt,a7 as Wt,j as Zt,ab as te,at as ee}from"./7PQ9d4dP.js";import{M as Et,C as P,_ as Ot,b as It}from"./D5X7BfX4.js";import{_ as ae}from"./C4WAmt-P.js";import{_ as le,b as ne,F as oe}from"./BQWyzQZp.js";import{_ as se}from"./CXUEa_s4.js";import{_ as ie}from"./RQfXHScZ.js";import{_ as re}from"./DqC-nx6a.js";import{_ as Tt}from"./UCCBr-NG.js";import{_ as ue}from"./BwlXDD88.js";import"./C3H6epDl.js";import"./D0WEjs_T.js";import"./DPPwigSW.js";import"./ao6LVzqx.js";import"./Z4E70_i9.js";import"./Do2gu6g3.js";import"./DD170oM2.js";const ce={class:"games-modal-content"},me={key:0,class:"games-list"},pe=ft({__name:"ChooseGameBattleModal",emits:["close","getGame"],setup(K,{emit:y}){const{t:k}=bt(),M=y,c=gt(),W=i(!0),R=i([]),H=i([]),V=i({}),et={type:Et.ACCORDION},L={val:0,text:k("all")},h=(s,_)=>{const v=[{value:"",text:k("all")},...Object.keys(s.category).map(f=>({value:f,text:s.category[Number(f)]}))],B=[{value:"",text:k("all")},...Object.keys(s.provider).map(f=>({value:f,text:s.provider[Number(f)]}))],A=B.find(f=>f.value===V.value.provider)||L;H.value=[{target:"search",componentName:P.SEARCH_INPUT,props:{modelValue:V.value.search||"",placeholderText:k("search"),isRequired:!0,searchIconSize:24},mobile:{class:"tw-col-span-4"}},{target:"category",componentName:P.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:`${k("type")}: `,displayedOption:"text",returnedOption:"value",defaultOption:v[0],itemList:v,isAllowEmpty:!1},mobile:{redirect:!0}},{target:"provider",componentName:P.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:`${k("providers")}: `,displayedOption:"text",returnedOption:"value",defaultOption:A,itemList:B,isAllowEmpty:!1},mobile:{redirect:!0}},{target:"sort",componentName:P.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:`${k("sort_by")}: `,defaultOption:_[0],itemList:_,isAllowEmpty:!1},mobile:{redirect:!0}}]},U=I(()=>({sort:"rating",per_page:42})),N=async()=>{try{const{data:s}=await c.fetchBattleGames(V.value);return R.value=s.items,s}catch(s){console.log("onMounted ChooseGameBattleModal.vue",s)}finally{W.value=!1}},b=s=>{V.value={...U.value,...s}},G=$t(s=>{b(s)});return xt(()=>V.value,N),ht(async()=>{const{filters:s,sort:_}=await N();h(s,_)}),(s,_)=>{const v=Ot,B=ue,A=St,f=Ct,Q=wt,q=Tt;return g(),C(kt,{to:"#globalModal"},[a(q,{"modal-max-width":"1024px","modal-width":"100%","without-bg":"",onClose:_[0]||(_[0]=m=>M("close"))},{title:r(()=>[S(p(t(k)("select_slot_game")),1)]),content:r(()=>[a(Q,{loading:t(W)},{default:r(()=>[e("div",ce,[a(v,{"mobile-settings":et,list:t(H),class:"filters",onChange:b,onInput:t(G)},null,8,["list","onInput"]),t(R).length?(g(),mt("div",me,[a(A,{"key-name":"games-list",list:t(R),container:!1},{item:r(({item:m})=>[a(B,{game:m,size:"small","is-linkable":!1,onClick:Z=>M("getGame",m)},null,8,["game","onClick"])]),_:1},8,["list"])])):(g(),C(f,{key:1,class:"tw-mt-4"}))])]),_:1},8,["loading"])]),_:1})])}}}),de=Nt(pe,[["__scopeId","data-v-2df42264"]]),j=K=>(Yt("data-v-62d38b41"),K=K(),Jt(),K),_e={class:"input-item tw-mt-0"},ve={class:"tw-flex tw-items-center"},ye={class:"tw-flex tw-flex-col"},fe={class:"ng-multiselect-label"},be={class:"tw-text-text-tertiary tw-mr-[2px]"},ge={class:"tw-flex tw-items-center"},xe={class:"tw-flex tw-flex-col"},he={class:"tw-text-text-tertiary tw-mr-[2px]"},we={class:"tooltip info"},Ne={class:"input-item"},ke={class:"input-item"},$e={class:"tw-flex tw-items-center"},Se={class:"tw-flex tw-flex-col"},Ce={class:"ng-multiselect-label"},Ve={class:"tooltip info"},Le={class:"input-item"},Be={class:"tooltip info"},Ee=j(()=>e("br",null,null,-1)),Oe=j(()=>e("br",null,null,-1)),Ie={class:"input-item"},Te={class:"tooltip info"},Me={class:"input-item"},Ue={class:"tooltip info"},Ge=j(()=>e("br",null,null,-1)),Ae=j(()=>e("br",null,null,-1)),qe={class:"input-item"},ze={class:"tooltip info"},Pe=j(()=>e("br",null,null,-1)),Re=j(()=>e("br",null,null,-1)),Fe={class:"input-item"},De={class:"tooltip info"},je=j(()=>e("br",null,null,-1)),He=j(()=>e("br",null,null,-1)),Qe={class:"tw-mt-6 tw-flex tw-justify-center"},Xe=ft({__name:"CreateBattleModal",emits:["close"],setup(K,{emit:y}){const k=Rt(),M=Ft(),{t:c}=bt(),W=y,R=gt(),H=Vt(),{getTiers:V,getBalance:et}=ct(H);let L;const h=i(""),U=i(""),N=i(null),b=i(""),G=i(0),s=i(0),_=i(""),v=i(0),B=i(0),A=i(!1),f=i(!1),Q=i(!1),q=i({}),m=i({}),Z=i(!0),X=i([]),z=i(!1),ot=I(()=>m.value.data.entry_fee_type.map(l=>({value:l,text:c(l.includes("points")?"points":"USD"),currency:l.includes("points")?"/img/GEM.png":Dt("USD"),balance:l.includes("points")?V.value.points:et.value}))),st=I(()=>m.value.data.battle_type.map(l=>({value:l,text:c(l)}))),at=I(()=>h.value.includes("points")?"points_entry_fee":"balance_entry_fee"),d=I(()=>{var l;return{[at.value]:G.value,battle_entry_time:B.value,battle_type:b.value,entry_fee_type:h.value,game_id:((l=N.value)==null?void 0:l.game_id)??0,is_private:A.value,participant_count:v.value,spins_count:s.value,stake_amount:_.value}}),u=I(()=>m.value.data),x=I(()=>h.value.includes("points")),$=I(()=>x.value?"points":"USD"),E=I(()=>x.value?Number(m.value.data.points_entry_fee.min):Number(m.value.data.balance_entry_fee.min)),O=I(()=>x.value?Number(m.value.data.points_entry_fee.max):Number(m.value.data.balance_entry_fee.max)),w=()=>{lt(),G.value=E.value},pt=l=>{var n;if(U.value=`${l.name} / ${l.soft}`,N.value=l,(n=l.pvp_data)!=null&&n.gameBattleAmount.length){X.value=l.pvp_data.gameBattleAmount.map(F=>({value:F,text:`${F} ${c(x.value?"points":"USD")}`}));const[tt]=l.pvp_data.gameBattleAmount;_.value=tt}else X.value=[],_.value="";f.value=!1},dt=async()=>{try{const{data:l}=await R.createNewBattle(d.value);H.setUserBattle(l),k.push(M({name:"battles-lobby-id",params:{id:l.battle_link}}))}catch(l){q.value=l}},_t=l=>{m.value=l,h.value=m.value.data.entry_fee_type[0],b.value=m.value.data.battle_type[0],G.value=Number(m.value.data.balance_entry_fee.min)||0,s.value=Number(m.value.data.spins_count.min)||0,v.value=Number(m.value.data.participant_range.min)||0,B.value=Number(m.value.data.battle_entry_time),lt(),Z.value=!1},lt=()=>{const l=x.value?m.value.data.points_entry_fee:m.value.data.balance_entry_fee,n={min:m.value.data.min_battle_entry_time,max:m.value.data.battle_entry_time},tt=m.value.data.participant_range,F=m.value.data.spins_count;L=jt().shape({[at.value]:nt().min(+l.min).max(+l.max).required(),battle_entry_time:nt().min(+n.min).max(+n.max).required(),battle_type:yt().required(),entry_fee_type:yt().required(),game_id:nt().required(),is_private:Ht(),participant_count:nt().min(+tt.min).max(+tt.max).required(),spins_count:nt().min(+F.min).max(+F.max).required(),stake_amount:yt().required()})},it=()=>{var l;if(!((l=N.value)!=null&&l.game_id))return!1;L.validate(d.value).then(()=>{z.value=!0}).catch(()=>{z.value=!1})};return xt(d,()=>{it()}),ht(async()=>{try{q.value={};const{data:l}=await R.fetchCreateBattleSettings();_t(l),it()}catch(l){q.value=l,Q.value=!0,Z.value=!1}}),(l,n)=>{const tt=le,F=Xt,vt=se,D=Lt,Y=ie,Mt=re,rt=ne,Ut=It,Gt=Bt,At=oe,qt=wt,zt=Tt,Pt=de;return g(),mt("div",null,[(g(),C(kt,{to:"#globalModal"},[a(zt,{"modal-max-width":"384px",class:"create-battle-modal",onClose:n[10]||(n[10]=o=>W("close"))},{title:r(()=>[S(p(t(c)("create_pvp_battle")),1)]),content:r(()=>[a(qt,{loading:t(Z)},{default:r(()=>[Object.keys(t(q)).length?(g(),C(tt,{key:0,error:t(q),validation:"",type:"message",class:"tw-mt-4 tw-mx-4"},null,8,["error"])):J("",!0),t(Q)?J("",!0):(g(),C(At,{key:1,class:"create-form",onSubmit:dt},{default:r(()=>[e("div",_e,[a(vt,{modelValue:t(h),"onUpdate:modelValue":n[0]||(n[0]=o=>T(h)?h.value=o:null),"default-option":t(ot)[0],"returned-option":"value","item-list":t(ot),onChange:w},{"selected-option":r(({props:o})=>[e("div",ve,[a(F,{src:o.currency,alt:o.currency,width:"24",height:"24",class:"tw-mr-2"},null,8,["src","alt"]),e("div",ye,[e("span",fe,p(t(c)("balance")),1),e("span",null,[S(p(o.balance)+" ",1),e("span",be,p(o.text),1)])])])]),option:r(({props:o})=>[e("div",ge,[a(F,{src:o.currency,alt:o.currency,width:"24",height:"24",class:"tw-mr-2"},null,8,["src","alt"]),e("div",xe,[e("span",null,[S(p(o.balance)+" ",1),e("span",he,p(o.text),1)])])])]),_:1},8,["modelValue","default-option","item-list"]),a(Y,null,{content:r(()=>[e("div",we,p(t(c)("balance_select_tooltip")),1)]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),e("div",Ne,[a(Mt,{modelValue:t(U),"onUpdate:modelValue":n[1]||(n[1]=o=>T(U)?U.value=o:null),"is-required":!0,"is-readonly":!0,"placeholder-text":l.$t("game"),"input-name":"game-id",class:"input-games",onClick:n[2]||(n[2]=o=>f.value=!0)},null,8,["modelValue","placeholder-text"])]),e("div",ke,[a(vt,{modelValue:t(b),"onUpdate:modelValue":n[3]||(n[3]=o=>T(b)?b.value=o:null),"default-option":t(st)[0],"additional-label":t(c)("battle_type"),"returned-option":"value","displayed-option":"text","item-list":t(st)},{"selected-option":r(({props:o})=>[e("div",$e,[a(D,{name:o.value,folder:"pvp",size:24,class:"tw-text-text-tertiary tw-mr-2"},null,8,["name"]),e("div",Se,[e("span",Ce,p(t(c)("battle_type")),1),e("span",null,p(o.text),1)])])]),_:1},8,["modelValue","default-option","additional-label","item-list"]),a(Y,null,{content:r(()=>[e("div",Ve,p(t(c)("battle_type_tooltip")),1)]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),e("div",Le,[(g(),C(rt,{key:t(O)+t(E),modelValue:t(G),"onUpdate:modelValue":n[4]||(n[4]=o=>T(G)?G.value=o:null),"is-required":!0,"placeholder-key":"jackpot_entry_price","suffix-key":t($),min:+t(E),max:+t(O),"input-name":"entry-price"},null,8,["modelValue","suffix-key","min","max"])),a(Y,null,{content:r(()=>[e("div",Be,[S(p(t(c)("jackpot_entry_price_tooltip"))+" ",1),Ee,Oe,S(" "+p(t(c)("range"))+": "+p(t(E))+" "+p(t($))+" - "+p(t(O))+" "+p(t($)),1)])]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),e("div",Ie,[(g(),C(vt,{key:t(_),modelValue:t(_),"onUpdate:modelValue":n[5]||(n[5]=o=>T(_)?_.value=o:null),"default-option":t(X)[0],"is-disabled":!t(X).length,"returned-option":"value","displayed-option":"text","additional-label":t(c)("stake_amount"),placeholder:t(c)("select_stake_amount"),"item-list":t(X)},null,8,["modelValue","default-option","is-disabled","additional-label","placeholder","item-list"])),a(Y,null,{content:r(()=>[e("div",Te,p(t(c)("stake_amount_tooltip")),1)]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),e("div",Me,[a(rt,{modelValue:t(s),"onUpdate:modelValue":n[6]||(n[6]=o=>T(s)?s.value=o:null),modelModifiers:{number:!0},"is-required":!0,min:+t(u).spins_count.min||0,max:+t(u).spins_count.max||0,"placeholder-key":"number_of_spins","input-name":"spins-number"},null,8,["modelValue","min","max"]),a(Y,null,{content:r(()=>[e("div",Ue,[S(p(t(c)("number_of_spins_tooltip"))+" ",1),Ge,Ae,S(" "+p(`${t(c)("range")}: ${t(u).spins_count.min} - ${t(u).spins_count.max}`),1)])]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),e("div",qe,[a(rt,{modelValue:t(v),"onUpdate:modelValue":n[7]||(n[7]=o=>T(v)?v.value=o:null),"is-required":!0,min:+t(u).participant_range.min||0,max:+t(u).participant_range.max||0,"placeholder-key":"participants","input-name":"participants"},null,8,["modelValue","min","max"]),a(Y,null,{content:r(()=>[e("div",ze,[S(p(t(c)("participants_tooltip"))+" ",1),Pe,Re,S(" "+p(`${t(c)("range")}: ${t(u).participant_range.min} - ${t(u).participant_range.max}`),1)])]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),e("div",Fe,[a(rt,{modelValue:t(B),"onUpdate:modelValue":n[8]||(n[8]=o=>T(B)?B.value=o:null),"is-required":!0,min:+t(u).min_battle_entry_time||0,max:+t(u).battle_entry_time||0,"placeholder-key":"start_time","suffix-key":"min","input-name":"start-time"},null,8,["modelValue","min","max"]),a(Y,null,{content:r(()=>[e("div",De,[S(p(t(c)("start_time_tooltip"))+" ",1),je,He,S(" "+p(`${t(c)("range")}: ${t(u).min_battle_entry_time} ${t(c)("minutes")} - ${t(u).battle_entry_time} ${t(c)("minutes")}`),1)])]),target:r(()=>[a(D,{size:20,name:"info",class:"tw-text-text-tertiary"})]),_:1})]),a(Ut,{modelValue:t(A),"onUpdate:modelValue":n[9]||(n[9]=o=>T(A)?A.value=o:null),"input-name":"tournament",name:"tournament","toggle-type":t(Qt).check,class:"tw-mt-4","label-text":t(c)("private_tournament")},null,8,["modelValue","toggle-type","label-text"]),e("div",Qe,[a(Gt,{type:"submit","label-key":"create_match","is-disabled":!t(z)},null,8,["is-disabled"])])]),_:1}))]),_:1},8,["loading"])]),_:1})])),t(f)?(g(),C(Pt,{key:0,onClose:n[11]||(n[11]=o=>f.value=!1),onGetGame:pt})):J("",!0)])}}}),Ye=Nt(Xe,[["__scopeId","data-v-62d38b41"]]),Je={class:"tw-mt-6 tw-pb-16 @tablet:tw-pb-10"},Ke={class:"tw-flex tw-items-center fg-title-20-fat"},We={class:"battles-tabs"},Ze={key:0,class:"battles-list"},ut=300,ta=ft({__name:"index",setup(K){Kt({title:"PVP Battles"});const{t:y}=bt(),k=Wt(),{isLoggedIn:M}=ct(k),{switchUser:c}=k,W=Zt(),{isMultiBalance:R}=ct(W),H=Vt(),{getUserBattle:V,getCurrency:et}=ct(H),L=i(!0),h=i(!1),U=i(!1),N=i(!1),b=i(null),G=gt(),s=i("available"),_=i([]),v=i({}),B=[{key:"available",label:"available"},{key:"active",label:"active"},{key:"completed",label:"completed"}],A=I(()=>!L.value&&b.value&&_.value.length),f=i({}),Q=i([]),q={type:Et.ACCORDION},m=async d=>{L.value=!0,f.value=d,v.value={status:s.value,...d},M.value&&(v.value={...v.value,my_battles:N.value}),await z(),setTimeout(()=>{L.value=!1},ut)},Z=$t(d=>{m(d)}),X=async()=>{v.value={...v.value,my_battles:N.value},await z()},z=async(d=!1)=>{d&&(h.value=!0);const{data:u}=await G.fetchBattles(v.value),{items:x,pagination:$}=u;return _.value=d?[..._.value,...x]:x,b.value=$,d&&setTimeout(()=>{h.value=!1},ut),u},ot=({filters:d,sort:u})=>{const x=[{value:"",text:y("all")},...d.battle_types.map(w=>({value:w,text:y(w)}))],$=[{value:"",text:y("all")},...d.providers.map(w=>({value:w.id,text:w.name}))],E=[...u.map(w=>({key:w,text:y(w)}))],O=[{value:"",text:y("all")},...d.prize.map(w=>({value:w,text:y(w)}))];Q.value=[{target:"q",componentName:P.SEARCH_INPUT,props:{modelValue:"",placeholderText:y("search"),isRequired:!0}},{target:"battle_type",componentName:P.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:`${y("type")}: `,displayedOption:"text",returnedOption:"value",defaultOption:x[0],itemList:x,isAllowEmpty:!1},mobile:{redirect:!0}},{target:"provider",componentName:P.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:`${y("providers")}: `,displayedOption:"text",returnedOption:"value",defaultOption:$[0],itemList:$,isAllowEmpty:!1},mobile:{redirect:!0}},{target:"prize",componentName:P.SINGLE_SELECTOR,props:{modelValue:"",additionalLabel:`${y("prize")}: `,displayedOption:"text",returnedOption:"value",defaultOption:O[0],itemList:O,isAllowEmpty:!1},mobile:{redirect:!0}},{target:"sort",componentName:P.SINGLE_SELECTOR,props:{modelValue:"default",additionalLabel:`${y("sort_by")}: `,displayedOption:"text",returnedOption:"key",defaultOption:E[0],itemList:E,isAllowEmpty:!1},mobile:{redirect:!0}}]},st=async()=>{var d;h.value=!0,v.value={status:s.value,...f.value,page:(d=b.value)==null?void 0:d.next_page},M.value&&(v.value={...v.value,my_battles:N.value}),await z(!0),setTimeout(()=>{h.value=!1},ut)},at=async()=>{try{L.value=!0,v.value={status:s.value,...f.value},await z()}catch(d){console.error("updateList battles/index",d)}finally{L.value=!1}};return xt(s,()=>{at(),N.value=!1}),ht(async()=>{var x,$,E,O;v.value={status:s.value};const{filters:d,sort:u}=await z();ot({filters:d,sort:u}),M.value&&R.value&&((x=V.value)==null?void 0:x.player_origin_currency)!==et.value&&((($=V.value)==null?void 0:$.battle_status)===1||((E=V.value)==null?void 0:E.battle_status)===2)&&c((O=V.value)==null?void 0:O.player_origin_currency),setTimeout(()=>{L.value=!1},ut)}),(d,u)=>{const x=Lt,$=te,E=It,O=Bt,w=Ot,pt=ae,dt=St,_t=Ct,lt=wt,it=ee,l=Ye;return g(),mt("div",Je,[e("h1",Ke,[a(x,{name:"pvp",size:24,class:"tw-text-input-fg tw-mr-2"}),S(" "+p(t(y)("battles")),1)]),e("div",We,[a($,{modelValue:t(s),"onUpdate:modelValue":u[0]||(u[0]=n=>T(s)?s.value=n:null),tabs:B,type:"primary"},null,8,["modelValue"]),t(M)?(g(),C(E,{key:0,modelValue:t(N),"onUpdate:modelValue":u[1]||(u[1]=n=>T(N)?N.value=n:null),name:"is-my-battles","input-name":"myBattles","label-text":t(y)("show_my_battles"),"toggle-position":"right",class:"tw-ms-4 @tablet:tw-ms-0 @tablet:tw-mt-4",onChange:X},null,8,["modelValue","label-text"])):J("",!0),t(M)?(g(),C(O,{key:1,"label-key":t(y)("create_battle"),class:"tw-ml-auto @tablet:tw-ml-0 @tablet:tw-w-full @tablet:tw-mt-4",size:"large",onClick:u[2]||(u[2]=n=>U.value=!0)},null,8,["label-key"])):J("",!0)]),a(w,{"mobile-settings":q,list:t(Q),class:"filter-list",onChange:m,onInput:t(Z)},null,8,["list","onInput"]),a(lt,{loading:t(L),class:"tw-mt-6"},{default:r(()=>[t(_).length?(g(),mt("div",Ze,[a(dt,{"key-name":"battles-list",list:t(_),container:!1},{item:r(({item:n})=>[a(pt,{item:n,onUpdateList:at},null,8,["item"])]),_:1},8,["list"])])):(g(),C(_t,{key:1}))]),_:1},8,["loading"]),t(A)&&t(b).next_page?(g(),C(it,{key:0,item:{total:t(b).total,total_pages:t(b).total,page:t(b).per_page*t(b).page},"item-count":t(_).length,class:"tw-mt-8"},{action:r(()=>[a(lt,{loading:t(h)},{default:r(()=>[a(O,{"label-key":"show_more","color-type":"outline",onClick:st})]),_:1},8,["loading"])]),_:1},8,["item","item-count"])):J("",!0),t(U)?(g(),C(l,{key:1,onClose:u[3]||(u[3]=n=>U.value=!1)})):J("",!0)])}}}),fa=Nt(ta,[["__scopeId","data-v-04e08723"]]);export{fa as default};
