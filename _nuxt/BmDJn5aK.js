import{d as L,a as Z,ag as H,aV as Y,a7 as G,j as ee,s as se,a0 as f,H as A,w as O,aJ as ce,o as p,c as S,e as T,b as D,g as l,O as z,B as E,i as B,ab as ie,A as Q,_ as K,a1 as F,aE as de,k as oe,a2 as pe,br as me,U as ae,t as V,aY as ve,h as ne,C as te,f as q,T as _e,bs as W}from"./7PQ9d4dP.js";import{_ as fe}from"./DqC-nx6a.js";import{c as he,_ as ye}from"./D4aeT6U_.js";import{c as we,d as be,_ as ge}from"./BQWyzQZp.js";import{_ as ke}from"./UCCBr-NG.js";import"./DD170oM2.js";import"./D0WEjs_T.js";var J=(k=>(k.EMAIL="email",k.PHONE="phone",k))(J||{});const Ce={class:"form-email-phone-container"},Se={class:"form-email-phone-main"},$e=L({__name:"StepEmailPhone",emits:["next","error","set-user"],setup(k,{emit:$}){const a=$,{t:n}=Z(),u=/^\+?[0-9]{10,15}$/,r=new Map(he.map(d=>[d.iso2,d])),e=[{key:J.EMAIL,label:n("email")},{key:J.PHONE,label:n("phone")}],C=H().email().required(),y=H().matches(u);let w=Y().shape({email:C});const b=G(),m=ee(),{postResetCode:h}=b,{getCountryCode:x}=se(m),s=f(J.EMAIL),c=f(""),_=f(""),I=f(""),i=f(!0),o=A(()=>e.reduce((d,{key:g})=>(d[g]=g===s.value,d),{})),P=A(()=>H().test("phone-or-default-code",n("phone_number_not_valid"),d=>d===I.value?!0:u.test(String(d)))),t=({phone:d,phoneCode:g})=>{_.value=g+d,I.value=g},v=async()=>{const d={};o.value.email?d.email=c.value:d.phone=I.value+_.value.replace(I.value,"-");try{await h(d),a("set-user",d),a("next")}catch(g){a("error",g)}},j=()=>{a("error",null),N(),c.value="",_.value="",i.value=!0},N=()=>{o.value.email?w=Y().shape({email:C}):o.value.phone&&(w=Y().shape({phone:y}))},M=()=>{var U;const d=((U=x.value)==null?void 0:U.toLowerCase())??"",g=r.get(d)??null;I.value=g?g==null?void 0:g.phone_code:""},R=async()=>{try{o.value.email?await w.validate({email:c.value}):o.value.phone&&await w.validate({phone:_.value}),i.value=!1}catch{i.value=!0}};return O(()=>s.value,()=>{j()}),O([c,_],async()=>{await R()}),ce(()=>{M()}),(d,g)=>{const U=ie,le=fe,ue=ye,re=Q;return p(),S("div",Ce,[T("div",Se,[D(U,{modelValue:l(s),"onUpdate:modelValue":g[0]||(g[0]=X=>z(s)?s.value=X:null),tabs:e,type:"primary","slider-settings":{spaceBetween:0}},null,8,["modelValue"]),l(o).email?(p(),E(le,{key:0,modelValue:l(c),"onUpdate:modelValue":g[1]||(g[1]=X=>z(c)?c.value=X:null),"is-validated-separately":"","is-required":"","validation-rules":l(C),"placeholder-text":d.$t("email")},null,8,["modelValue","validation-rules","placeholder-text"])):B("",!0),l(o).phone?(p(),E(ue,{key:1,"is-required":"","default-code":l(I),"placeholder-key":"phone","is-validated-separately":"","validation-rules":l(P),onChange:t},null,8,["default-code","validation-rules"])):B("",!0)]),D(re,{"is-disabled":l(i),"label-key":"confirm",onClick:v},null,8,["is-disabled"])])}}}),xe=K($e,[["__scopeId","data-v-ecbaaa79"]]),Ie={style:{display:"flex","align-items":"center"}},Pe=["type","inputmode","placeholder","disabled"],Ne={key:0},Te=["innerHTML"],Be=L({__name:"single-otp-input",props:{inputType:{default:"tel"},inputmode:{default:"numeric"},value:{},separator:{default:""},focus:{type:Boolean,default:!1},inputClasses:{default:""},conditionalClass:{default:""},shouldAutoFocus:{type:Boolean,default:!1},isLastChild:{type:Boolean,default:!1},placeholder:{default:""},isDisabled:{type:Boolean,default:!1}},emits:["on-change","on-keydown","on-paste","on-focus","on-blur"],setup(k,{emit:$}){const a=k,n=$,u=f(a.value||""),r=f(null),e=()=>(u.value=u.value,u.value.length>1&&(u.value=u.value.slice(0,1)),n("on-change",u.value.toString())),C=s=>s>=65&&s<=90,y=s=>s>=48&&s<=57||s>=96&&s<=105,w=s=>{a.isDisabled&&s.preventDefault();const c=s||window.event,_=c.which?c.which:c.keyCode;y(_)||a.inputType==="letter-numeric"&&C(_)||[8,9,13,37,39,46,86].includes(_)?n("on-keydown",s):c.preventDefault()},b=s=>n("on-paste",s),m=()=>(r.value.select(),n("on-focus")),h=()=>n("on-blur"),x=A(()=>["letter-numeric","number"].includes(a.inputType)?"text":a.inputType);return O(()=>a.value,(s,c)=>{s!==c&&(u.value=s)}),O(()=>a.focus,(s,c)=>{c!==s&&r.value&&a.focus&&(r.value.focus(),r.value.select())}),oe(()=>{r.value&&a.focus&&a.shouldAutoFocus&&(r.value.focus(),r.value.select())}),(s,c)=>(p(),S("div",Ie,[pe(T("input",{"data-test":"single-input",type:x.value,inputmode:s.inputmode,placeholder:s.placeholder,disabled:s.isDisabled,ref_key:"input",ref:r,min:"0",max:"9",maxlength:1,pattern:"[0-9]","onUpdate:modelValue":c[0]||(c[0]=_=>u.value=_),class:ae([s.inputClasses,s.conditionalClass,{"is-complete":u.value}]),onInput:e,onKeydown:w,onPaste:b,onFocus:m,onBlur:h},null,42,Pe),[[me,u.value]]),!s.isLastChild&&s.separator?(p(),S("span",Ne,[T("span",{innerHTML:s.separator},null,8,Te)])):B("",!0)]))}}),De={style:{display:"flex"},class:"otp-input-container"},Ee={key:0,autocomplete:"off",name:"hidden",type:"text",style:{display:"none"}},Me=8,Ve=37,Oe=39,je=46,Re=L({__name:"vue3-otp-input",props:{value:{default:""},numInputs:{default:4},separator:{default:""},inputClasses:{default:""},conditionalClass:{},inputType:{},inputmode:{default:"text"},shouldAutoFocus:{type:Boolean,default:!1},placeholder:{},isDisabled:{type:Boolean},shouldFocusOrder:{type:Boolean}},emits:["update:value","on-change","on-complete"],setup(k,{expose:$,emit:a}){const n=k,u=a,r=f(0),e=f([]),C=f([]);O(()=>n.value,t=>{if(t.length===n.numInputs||e.value.length===0){const v=t.split("");e.value=v}},{immediate:!0});const y=t=>{r.value=t},w=()=>{r.value=-1},b=()=>e.value.join("").length===n.numInputs?(u("update:value",e.value.join("")),u("on-complete",e.value.join(""))):"Wait until the user enters the required number of characters",m=t=>{r.value=Math.max(Math.min(n.numInputs-1,t),0)},h=()=>{m(r.value+1)},x=()=>{m(r.value-1)},s=t=>{C.value=Object.assign([],e.value),e.value[r.value]=t.toString(),C.value.join("")!==e.value.join("")&&(u("update:value",e.value.join("")),u("on-change",e.value.join("")),b())},c=t=>{t.preventDefault();const v=t.clipboardData.getData("text/plain").slice(0,n.numInputs-r.value).split("");if(n.inputType==="number"&&!v.join("").match(/^\d+$/)||n.inputType==="letter-numeric"&&!v.join("").match(/^\w+$/))return"Invalid pasted data";const j=e.value.slice(0,r.value).concat(v);return j.slice(0,n.numInputs).forEach(function(N,M){e.value[M]=N}),m(j.slice(0,n.numInputs).length),b()},_=t=>{s(t),h()},I=()=>{e.value.length>0&&(u("update:value",""),u("on-change","")),e.value=[],r.value=0},i=t=>{const v=t.split("");v.length===n.numInputs&&(e.value=v,u("update:value",e.value.join("")),u("on-complete",e.value.join("")))},o=(t,v)=>{switch(t.keyCode){case Me:t.preventDefault(),s(""),x();break;case je:t.preventDefault(),s("");break;case Ve:t.preventDefault(),x();break;case Oe:t.preventDefault(),h();break;default:P(v);break}},P=t=>{n.shouldFocusOrder&&setTimeout(()=>{const v=e.value.join("").length;t-v>=0&&(r.value=v,e.value[t]="")},100)};return $({clearInput:I,fillInput:i}),(t,v)=>(p(),S("div",De,[t.inputType==="password"?(p(),S("input",Ee)):B("",!0),(p(!0),S(F,null,de(t.numInputs,(j,N)=>{var M,R;return p(),E(Be,{key:N,focus:r.value===N,value:e.value[N],separator:t.separator,"input-type":t.inputType,inputmode:t.inputmode,"input-classes":t.inputClasses,conditionalClass:(M=t.conditionalClass)==null?void 0:M[N],"is-last-child":N===t.numInputs-1,"should-auto-focus":t.shouldAutoFocus,placeholder:(R=t.placeholder)==null?void 0:R[N],"is-disabled":t.isDisabled,onOnChange:_,onOnKeydown:d=>o(d,N),onOnPaste:c,onOnFocus:d=>y(N),onOnBlur:w},null,8,["focus","value","separator","input-type","inputmode","input-classes","conditionalClass","is-last-child","should-auto-focus","placeholder","is-disabled","onOnKeydown","onOnFocus"])}),128))]))}}),Fe={class:"form-security-code-container"},Ae={class:"form-security-code-headering"},Le={class:"form-security-code-main"},Ue={class:"form-security-code-message"},qe={class:"form-security-code-footer"},He=L({__name:"StepSecurityCode",props:{user:{}},emits:["next","error","set-token"],setup(k,{emit:$}){const a=$,n=k,u=G(),{t:r}=Z(),{postResetCode:e,postCheckCode:C}=u,y=f(""),w=f(!0),b=f(59),m=f(!1),h=A(()=>w.value?`${r("resend_code")} 00:${b.value.toString().padStart(2,"0")}`:r("resend_code")),x=A(()=>y.value.length<6),s=async()=>{try{const i={...n.user,code:Number(y.value)},{data:{session_token:o}}=await C(i);a("set-token",o),a("next")}catch(i){const o=i;m.value=!0,a("error",o)}},c=()=>{const i=ve(()=>{b.value>0?b.value-=1:(clearInterval(i),w.value=!1)},1e3)},_=async()=>{try{await e(n.user),I(),a("error",null)}catch(i){a("error",i)}},I=()=>{b.value=59,w.value=!0,c()};return oe(()=>{c()}),O(()=>y.value,()=>{y.value&&m.value&&(m.value=!1,a("error",null))}),(i,o)=>{const P=Q;return p(),S("div",Fe,[T("span",Ae,V(i.$t("security_code")),1),T("div",Le,[D(l(Re),{value:l(y),"onUpdate:value":o[0]||(o[0]=t=>z(y)?y.value=t:null),class:ae({"no-valid":l(m)}),"input-classes":"otp-input-input","conditional-class":["one","two","three","four","five","six"],separator:"","input-type":"number","num-inputs":6,"should-auto-focus":!0,"should-focus-order":!0},null,8,["value","class"]),T("span",Ue,V(i.$t("check_inbox_for_security_code")),1)]),T("div",qe,[D(P,{label:l(h),"is-disabled":l(w),onClick:_},null,8,["label","is-disabled"]),D(P,{"label-key":"confirm","is-disabled":l(x),onClick:s},null,8,["is-disabled"])])])}}}),ze=K(He,[["__scopeId","data-v-b0f2664b"]]),Ke={class:"form-new-password-container"},We={class:"form-new-password-main"},Ye=L({__name:"StepNewPassword",props:{user:{},token:{}},emits:["next","error"],setup(k,{emit:$}){const a=$,n=k,u=ee(),r=G(),{t:e}=Z(),{postResetPassword:C}=r,{getPasswordData:y}=se(u),w=new RegExp(y.value.regular,"g"),b=H().matches(w,e("must_contain")),m=f(""),h=f(""),x=f(!0),s=A(()=>H().test("password_confirmation",e("passwords_do_not_match"),i=>i===m.value)),c=Y().shape({password:b,confirmPassword:s.value}),{errors:_}=we({validationSchema:c}),I=async()=>{try{const i={password:m.value,confirm_password:h.value,session_token:n.token,...n.user};await C(i),a("next")}catch(i){a("error",i)}};return O(()=>_.value,()=>{Object.keys(_.value).length||!m.value||!h.value?x.value=!0:x.value=!1}),(i,o)=>{const P=be,t=Q;return p(),S("div",Ke,[T("div",We,[D(P,{modelValue:l(m),"onUpdate:modelValue":o[0]||(o[0]=v=>z(m)?m.value=v:null),"input-name":"password","is-required":"","placeholder-key":"new_password"},null,8,["modelValue"]),D(P,{modelValue:l(h),"onUpdate:modelValue":o[1]||(o[1]=v=>z(h)?h.value=v:null),"input-name":"confirmPassword","is-required":"","placeholder-key":"confirm_new_password"},null,8,["modelValue"])]),D(t,{"label-key":"Confirm","is-disabled":l(x),onClick:I},null,8,["is-disabled"])])}}}),Je=K(Ye,[["__scopeId","data-v-74c70644"]]),Ge={},Qe={class:"form-success-container"},Xe={class:"form-success-main"},Ze={class:"form-success-message"};function et(k,$){const a=ne,n=Q;return p(),S("div",Qe,[T("div",Xe,[D(a,{name:"pass_success",class:"pass-success",size:64,"pass-success":""}),T("span",Ze,V(k.$t("your_password_successfully")),1)]),D(n,{"label-key":"sign_in",onClick:$[0]||($[0]=u=>k.$emit("submit"))})])}const tt=K(Ge,[["render",et],["__scopeId","data-v-3a9eb4ca"]]),st={class:"forgot-password-header"},ot={class:"forgot-password-container"},at={class:"forgot-password-message"},nt={class:"forgot-password-body"},lt=L({__name:"ForgotPassword",setup(k){const $=G(),a=ee(),{setForgotPasswordModal:n,setAuthModal:u}=$,{setOpenedModalName:r}=a,e=f({emailPhone:!0,securityCode:!1,newPassword:!1,success:!1}),C=f({}),y=f(null),w=f(""),b=o=>{const P={};Object.keys(e.value).forEach(t=>{P[t]=!1}),P[o]=!0,e.value=P},m=()=>{e.value.emailPhone?b(W.SECURITY_CODE):e.value.securityCode?b(W.NEW_PASSWORD):e.value.newPassword&&b(W.SUCCESS),h(null)},h=o=>{y.value=o},x=o=>{C.value=o},s=o=>{w.value=o},c=()=>{e.value.securityCode?b(W.EMAIL_PHONE):e.value.emailPhone&&_()},_=()=>{i(),I("signIn")},I=o=>{r(o),u(o)},i=()=>{n(!1)};return O(()=>e.value,()=>{h(null)}),(o,P)=>{const t=ne,v=xe,j=ze,N=Je,M=tt,R=ge,d=ke;return p(),E(_e,{to:"#globalModal"},[D(d,{class:"forgot-password-modal","modal-max-width":"512px","fullscreen-mode":"",onClose:i},{title:te(()=>[T("div",st,[l(e).success?(p(),S(F,{key:0},[q(V(o.$t("success")),1)],64)):(p(),S(F,{key:1},[l(e).newPassword?B("",!0):(p(),S("button",{key:0,class:"back-button",onClick:c},[D(t,{name:"left_arrow",class:"back-icon",size:16})])),q(" "+V(o.$t("reset_password")),1)],64))])]),content:te(()=>[T("div",ot,[T("div",at,[l(e).emailPhone?(p(),S(F,{key:0},[q(V(o.$t("reset_password_enter_email_or_phone")),1)],64)):B("",!0),l(e).securityCode?(p(),S(F,{key:1},[q(V(o.$t("check_security_code")),1)],64)):B("",!0),l(e).newPassword?(p(),S(F,{key:2},[q(V(o.$t("reset_new_password")),1)],64)):B("",!0)]),T("div",nt,[l(e).emailPhone?(p(),E(v,{key:0,onNext:m,onSetUser:x,onError:h})):B("",!0),l(e).securityCode?(p(),E(j,{key:1,user:l(C),onSetToken:s,onNext:m,onError:h},null,8,["user"])):B("",!0),l(e).newPassword?(p(),E(N,{key:2,token:l(w),user:l(C),onNext:m,onError:h},null,8,["token","user"])):B("",!0),l(e).success?(p(),E(M,{key:3,onSubmit:_})):B("",!0),l(y)?(p(),E(R,{key:4,error:l(y)},null,8,["error"])):B("",!0)])])]),_:1})])}}}),vt=K(lt,[["__scopeId","data-v-65a3fd67"]]);export{vt as default};
