import{d as T,a as q,o as c,c as p,e as r,r as A,f as J,t as g,U as M,g as $,B as Y,C as N,i as B,V as Z,E as O,b as L,n as Q,aO as G,p as x,X as ee,aa as te,j as se,aM as ae,s as ne,a0 as h,aX as oe,H as P,k as ie,aY as re,l as le,aZ as d,a_ as R,R as ce,a$ as z,b0 as ue,aJ as me,N as de,S as pe,b1 as ve,a1 as _e,aE as fe,_ as ge}from"./7PQ9d4dP.js";import{v as he}from"./D0WEjs_T.js";var v=(t=>(t.month="30",t.week="7",t.day="1",t))(v||{});const k="none";var f=(t=>(t[t.large=14]="large",t[t.medium=10]="medium",t[t.mediumMin=8]="mediumMin",t[t.small=6]="small",t[t.smallExtra=4]="smallExtra",t))(f||{});const Le={class:"control-panel"},ke=["onClick"],ye=T({__name:"LiveWinsControlPanel",props:{currentFilter:{},filterList:{}},emits:["filter"],setup(t){const{t:i}=q(),u=a=>{switch(a){case v.month:return i("month_m");case v.week:return i("week_w");case v.day:return i("day_d")}};return(a,n)=>{const o=Z;return c(),p("header",Le,[r("button",{class:M(["none-filter-button",{active:a.currentFilter===$(k)}]),onClick:n[0]||(n[0]=e=>a.$emit("filter",$(k)))},[A(a.$slots,"header-ico"),J(" "+g(a.$t("live_wins")),1)],2),a.filterList?(c(),Y(o,{key:0,list:a.filterList,"key-name":"wins-filter",class:"filter-list"},{item:N(({item:e})=>[r("button",{class:M(["filter-button",{active:a.currentFilter===e}]),onClick:m=>a.$emit("filter",e)},g(u(e)),11,ke)]),_:1},8,["list"])):B("",!0)])}}}),we={class:"game-item"},$e={class:"game-content"},be={class:"game-payout"},We={class:"game-amount"},Se={class:"nickname"},Ne=T({__name:"LiveWinsItem",props:{item:{}},setup(t){const i=t,{PLATFORM_ID:u}=O().public,a=n=>["8dfa5f04-fa62-4634-a170-d65019070b5f","6ed534e6-fe06-428f-b15f-e769cbbfe1c4","45cab422-ae18-45d9-acde-e0ddead0091a"].includes(u)?G(n):n;return(n,o)=>{const e=x;return c(),p("div",we,[L(e,{alt:n.item.game,src:i.item.banner_vertical,class:"tw-object-cover game-image"},null,8,["alt","src"]),r("div",$e,[r("div",be,[r("div",We,g(a(n.item.amount)),1),L(e,{class:"payout-icon",src:$(Q)(n.item.currency),alt:n.item.currency},null,8,["src","alt"])]),r("div",Se,g(n.item.nickname),1)])])}}}),Te=()=>{const t=ee(),i=te(),u=se(),{$echo:a}=ae(),{PLATFORM_ID:n}=O().public,{getContainerWidth:o}=ne(u),e=h([]),m=h([]),b=100,W=24,_=h(null),y=h(!1),S=h(k),w=oe({error_code:0,status:!0,msg:""}),E=P(()=>o.value>=d.desktopLarge?f.large:o.value>=d.desktop&&o.value<=d.desktopLarge?f.medium:o.value>=d.tablet&&o.value<=d.desktop?f.mediumMin:o.value>=d.mobileLarge&&o.value<=d.tablet?f.small:f.smallExtra),D=P(()=>e.value.slice(0,E.value)??[]),C=s=>{const{msg:l="Wrong request LiveWins",status:K,error_code:X=0}=s;w.msg=l,w.status=K,w.error_code=X},I=async()=>{try{const s=await R.wins.getLiveWins();e.value=s.map(l=>({...l,id:he()}))}catch(s){C(s),console.error("useLiveWins.ts -> fetchLiveWins",s)}},F=async s=>{try{const l=await R.wins.getTopWins({filter:s});e.value=l}catch(l){C(l),console.error("useLiveWins.ts -> fetchTopWins",l)}},U=async s=>{switch(S.value=s,y.value=!0,s){case k:await I();break;case v.day:case v.month:case v.week:await F(s);break;default:console.error("Type of filter is not defined")}y.value=!1},V=s=>{i.push(t({name:ce.games_id,params:{id:s.game_id}}))},j=()=>{a.channel(`${z.liveTransactionsCompany}.${n}`).listen(ue.liveWins,s=>{m.value.length<b&&m.value.push(s.liveWins)})},H=()=>a.leaveChannel(`${z.liveTransactionsCompany}.${n}`);return ie(()=>{j(),_.value=re(()=>{if(m.value.length)if(S.value!==k)m.value.pop();else{const s=m.value.pop();s.id=Date.now(),e.value.length>W&&e.value.pop(),e.value.unshift(s)}},1e3)}),le(()=>{H(),clearInterval(_.value)}),{fetchTopWins:F,fetchLiveWins:I,gridSize:E,list:e,onFilter:U,onGoTo:V,slicedList:D,loading:y,filter:S,errorStatus:w}},Ee={key:0,class:"ng-live-wins"},Ce={class:"content-container"},Ie={key:1,class:"empty-result"},Fe=T({__name:"LiveWins",props:{filterList:{},currentFilter:{},list:{},gridSize:{}},emits:["update","go-to"],setup(t,{emit:i}){const{errorStatus:u}=Te(),a=t,n=i,o=e=>{a.currentFilter!==e&&n("update",e)};return me(()=>n("update",a.currentFilter)),(e,m)=>{const b=ye,W=Ne;return $(u).status?(c(),p("div",Ee,[L(b,de({currentFilter:e.currentFilter,filterList:[...new Set(e.filterList)]},{onFilter:o}),{"header-ico":N(()=>[A(e.$slots,"header-icon",{},void 0,!0)]),_:3},16),r("div",Ce,[e.list.length?(c(),p("div",{key:0,class:"wins-grid tw-grid",style:pe(`grid-template-columns: repeat(${e.gridSize+1}, calc(100% / ${e.gridSize}));`)},[L(ve,{name:"wins"},{default:N(()=>[(c(!0),p(_e,null,fe(e.list,_=>(c(),p("div",{key:_.id,class:"tw-mx-1 tw-transition-transform"},[L(W,{item:_,onClick:y=>e.$emit("go-to",_)},null,8,["item","onClick"])]))),128))]),_:1})],4)):(c(),p("div",Ie,[r("p",null,g(e.$t("no_results_yet")),1),r("p",null,g(e.$t("be_first_winner")),1)]))])])):B("",!0)}}}),Re=ge(Fe,[["__scopeId","data-v-429a72eb"]]);export{v as L,Re as _,Te as u};
