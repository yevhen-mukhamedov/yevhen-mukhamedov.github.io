import{_ as U}from"./CwMDRuuH.js";import{d as T,a as z,H as v,o as e,c as d,b as h,C,e as s,t as c,g as t,aH as E,U as L,B as m,i as g,a1 as V,A as j,aE as N,r as q,p as J,h as W,aL as X,J as G,ai as Q,aa as Z,X as tt,aI as et,a0 as P,b3 as st,W as F,k as at,F as nt,a4 as ot,O as ct,b4 as it}from"./7PQ9d4dP.js";import{T as rt,E as I,a as H,u as lt}from"./DqC-nx6a.js";import{_ as pt}from"./B-kqbjFD.js";import{a as ut}from"./CXUEa_s4.js";import"./BQWyzQZp.js";import"./DD170oM2.js";import"./Cl6uPZ89.js";import"./D0WEjs_T.js";const _t={class:"ticket-header"},dt={class:"ticket-header-date"},kt={class:"tw-text-base tw-font-bold tw-me-2"},mt={class:"tw-text-text-brand tw-text-base"},gt={class:"ticket-header-status"},ht=T({__name:"SingleTicketHeader",props:{ticketId:{},ticket:{},onCloseTicket:{type:Function}},setup(k){const a=k,{t:u}=z(),_=v(()=>rt[a.ticket.status]),n=v(()=>_.value.statusKey),r=v(()=>"status-"+_.value.name);return(i,f)=>{const B=U,M=j;return e(),d(V,null,[h(B,{"title-key":"ticket_capitalize","icon-name":"contact-us"},{additionalTitle:C(()=>[s("span",null,"#"+c(i.ticketId),1)]),_:1}),s("div",_t,[s("div",dt,[s("span",kt,c(t(u)("date_created"))+":",1),s("span",mt,c(t(E)(i.ticket.created_at)),1)]),s("div",gt,[s("span",null,c(t(u)("status"))+":",1),s("div",{class:L(["tw-p-1 tw-rounded fg-main-12-fat tw-text-text-dark",t(r)])},c(t(u)(t(n))),3)]),i.ticket.status===t(I).Opened||i.ticket.status===t(I).InProgress?(e(),m(M,{key:0,"label-key":"close_ticket","color-type":"outline",class:"ticket-header-button",onClick:f[0]||(f[0]=w=>i.onCloseTicket(i.ticketId))})):g("",!0)])],64)}}}),ft={class:"messages-list"},wt={class:"tw-flex tw-justify-between fg-main-14-fat"},yt={key:0},$t={key:1},vt={class:"tw-text-text-tertiary tw-text-right fg-main-14-thin"},Tt={class:"tw-text-text-secondary fg-main-14-thin tw-mt-2"},bt={key:0,class:"tw-flex tw-flex-wrap tw-gap-2 tw-mt-2"},St=["href"],Ct=T({__name:"SingleTicketMessagesList",props:{messages:{}},setup(k){return(a,u)=>{const _=J;return e(),d("div",ft,[(e(!0),d(V,null,N(a.messages,n=>(e(),d("div",{key:n.id,class:L(["message-wrapper",{"message-wrapper--support":n.author===t(H).SupportManager}])},[s("div",wt,[n.author===t(H).Me?(e(),d("span",yt,c(a.$t("me")),1)):(e(),d("span",$t,c(a.$t("support_manager")),1)),s("div",vt,c(t(E)(n.created_at)),1)]),s("div",Tt,c(n.content),1),n.attachments.length?(e(),d("div",bt,[(e(!0),d(V,null,N(n.attachments,(r,i)=>(e(),d("a",{key:i,href:r.url,target:"_blank",class:"attachment-img"},[h(_,{src:r.url,alt:"attachment img"},null,8,["src"]),s("span",null,c(r.name),1)],8,St))),128))])):g("",!0)],2))),128)),q(a.$slots,"pagination")])}}}),It={key:0,class:"ticket-thank"},Bt={class:"ticket-thank-title"},Mt={class:"ticket-thank-desc"},Vt={class:"ticket-thank-desc"},xt=T({__name:"TicketThankYouBlock",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(k,{emit:a}){const u=k,_=a,n=()=>_("update:modelValue",!1);return(r,i)=>u.modelValue?(e(),d("div",It,[h(t(X),{class:"ticket-thank-btn","color-type":"outlined",onClick:n},{default:C(()=>[h(t(W),{name:"close",size:12})]),_:1}),s("h2",Bt,c(r.$t("thank_you_for")),1),s("p",Mt,c(r.$t("we_appreciate")),1),s("p",Vt,c(r.$t("while_we_do_our_best")),1)])):g("",!0)}}),Nt=T({__name:"SingleTicketMain",props:{ticketId:{},ticket:{},onCloseTicket:{type:Function}},setup(k){const{show:a}=G(),u=Q(),_=Z(),n=tt(),r=k,{t:i}=z(),f=et(),{closeTicket:B,fetchSingleTicket:M}=f,w=P(!!u.query.new),l=P({page:1,total:0,next_page:null,per_page:10,prev_page:null,total_pages:0}),{setBreadcrumbs:R}=st();R([{label:i("support"),path:F.contact_us},{label:`${i("ticket_capitalize")} #${u.params.id.toString()}`}]);const y=v(()=>f.ticket),O=v(()=>{var o;const p=(o=y.value)==null?void 0:o.status;return p===I.Opened||p===I.InProgress}),Y=({page:p,perPage:o})=>{l.value.per_page!==o?l.value.page=1:l.value.page=p,l.value.per_page=o,x()},x=async()=>{try{const p=await M(r.ticketId,{page:l.value.page,per_page:l.value.per_page}),{per_page:o,current_page:$,total:b}=p.messages;l.value={per_page:o,total:b,page:$,next_page:$+1,prev_page:$-1,total_pages:Math.ceil(b/o)}}catch(p){const{msg:o}=p;a({message:o,type:"error"}),_.push(n({path:F.contact_us}))}};return at(()=>{x()}),nt({title:()=>y.value.title??"Tickets item"}),(p,o)=>{const $=ht,b=Ct,A=xt,D=pt,K=ot;return e(),m(K,{loading:t(y)===null},{default:C(()=>[h($,{ticket:t(y),"on-close-ticket":t(B),"ticket-id":p.ticketId},null,8,["ticket","on-close-ticket","ticket-id"]),h(b,{messages:t(y).messages.data},{pagination:C(()=>{var S;return[((S=t(l))==null?void 0:S.total_pages)>1?(e(),m(ut,{key:0,class:"tickets-pagination","current-page":t(l).page,total:t(l).total,pages:t(l).total_pages,"per-page":10,onChange:Y},null,8,["current-page","total","pages"])):g("",!0)]}),_:1},8,["messages"]),t(w)?(e(),m(A,{key:0,modelValue:t(w),"onUpdate:modelValue":o[0]||(o[0]=S=>ct(w)?w.value=S:null)},null,8,["modelValue"])):g("",!0),t(O)?(e(),m(D,{key:1,"ticket-id":p.ticketId},null,8,["ticket-id"])):g("",!0)]),_:1},8,["loading"])}}}),At=T({__name:"[id]",setup(k){return lt(),(a,u)=>{const _=Nt;return e(),m(_,{"ticket-id":(a._.provides[it]||a.$route).params.id},null,8,["ticket-id"])}}});export{At as default};
