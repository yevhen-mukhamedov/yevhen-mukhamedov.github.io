import{_ as se}from"./CwMDRuuH.js";import{u as oe,c as ne,_ as le}from"./BQWyzQZp.js";import{I as ce,A as re,_ as ie,u as ue}from"./DqC-nx6a.js";import{d as x,a as M,a0 as U,H as j,o,c as d,g as t,t as f,i as p,e as m,r as z,Z as de,U as D,aa as me,ai as pe,X as _e,aI as fe,a7 as G,s as W,W as E,aV as P,ag as S,bI as he,B as $,b as u,C as A,a1 as ye,aE as ge,h as ke,A as ve,Y as be,aL as $e,p as we,_ as Ie,b3 as Te,aq as Ve,F as Se}from"./7PQ9d4dP.js";import{_ as Re}from"./Cl6uPZ89.js";const Fe=["for"],qe={class:"input-container"},Be={key:0,class:"input-placeholder"},Ce=["id","value","name","readonly","disabled","required","autocomplete"],Le={key:0,class:"input-suffix"},Ke={class:"input-message"},Ne={key:0,class:"input-support-text"},je={key:1,class:"ng-control-error-message"},Ee=x({__name:"NgTextarea",props:{isLabelShown:{type:Boolean,default:!1},inputName:{default:""},labelKey:{default:""},isReadonly:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1},placeholderKey:{default:""},isRequired:{type:Boolean,default:!1},isAutocomplete:{type:Boolean,default:!0},classes:{default:""},modelValue:{default:""},isValidatedSeparately:{type:Boolean,default:!1},validationRules:{default:null},supportingTextKey:{},suffixKey:{},resize:{default:"none"}},emits:["input","blur","focus","update:modelValue"],setup(C,{emit:R}){const{t:c}=M(),l=C,{value:y,errorMessage:h}=oe(()=>l.inputName,l.isValidatedSeparately?l.validationRules:null,{syncVModel:!0}),w=U(!1),L=j(()=>`
    ${l.classes}
    ${h.value?"ng-control-error":""}
    `),I=j(()=>l.isLabelShown&&l.labelKey),F=j(()=>l.isRequired?c(l.labelKey):`${c(l.labelKey)} (${c("optional")})`),k=j(()=>!l.isRequired&&!I.value?`${c(l.placeholderKey)} (${c("optional")})`:c(l.placeholderKey)),T=R,s=a=>{const r=a.target;T("update:modelValue",r.value),T("input",r.value)},K=a=>{const r=a.target;w.value=!0,T("focus",r.value)},v=a=>{const r=a.target;w.value=!1,T("blur",r.value)};return(a,r)=>(o(),d("div",{class:D([[t(L),{focus:t(w),active:a.modelValue,placeholder:a.placeholderKey,error:t(h),disabled:a.isDisabled}],"ng-control ng-textarea"])},[t(I)?(o(),d("label",{key:0,class:"ng-control-label",for:a.inputName},f(t(F)),9,Fe)):p("",!0),m("div",{class:D([[{"ng-control-inner-icon-left":a.$slots.leftIcon,"ng-control-inner-icon-right":a.$slots.rightIcon}],"ng-control-inner"])},[z(a.$slots,"leftIcon"),m("div",qe,[a.placeholderKey?(o(),d("div",Be,f(t(k)),1)):p("",!0),m("textarea",{id:a.inputName,value:t(y),class:"ng-control-input",name:a.inputName,readonly:"isReadonly"in a?a.isReadonly:t(de),disabled:a.isDisabled,required:a.isRequired,autocomplete:a.isAutocomplete?"on":"off",onInput:r[0]||(r[0]=b=>s(b)),onBlur:r[1]||(r[1]=b=>v(b)),onFocus:r[2]||(r[2]=b=>K(b))},null,40,Ce)]),a.suffixKey?(o(),d("div",Le,f(t(c)(a.suffixKey)),1)):p("",!0),z(a.$slots,"rightIcon")],2),m("div",Ke,[a.supportingTextKey&&!t(h)?(o(),d("span",Ne,f(t(c)(a.supportingTextKey)),1)):p("",!0),t(h)?(o(),d("span",je,f(t(c)(t(h))),1)):p("",!0)])],2))}}),Ue={class:"form-actions"},Ae={class:"form-files-button"},De={class:"tw-relative"},xe={class:"tw-text-text-tertiary tw-text-base"},Me={key:4,class:"tw-mt-4 tw-flex tw-items-center tw-flex-wrap tw-gap-4"},Oe={class:"fg-info-12-thin file-name"},ze={key:5,class:"create-actions"},Pe={key:1,class:"guest-success"},Ge={class:"guest-success-title"},We={class:"guest-success-desc"},He={class:"guest-success-desc"},Xe=x({__name:"TicketForm",props:{ticketId:{}},setup(C){const{t:R}=M(),c=me(),l=pe(),y=_e(),h=C,{createTicket:w,createGuestTicket:L,createReplyTicket:I}=fe(),F=G(),{isLoggedIn:k}=W(F),T=l.path===E.contact_us_create,s=U({name:"",email:"",subject:"",message:"",attachments:[]}),K=U(!1),v=U({}),a=()=>{s.value={name:"",email:"",subject:"",message:"",attachments:[]}},r={validationSchema:P({subject:S().required(),message:S().required()})},b={validationSchema:P({subject:S().required(),message:S().required(),name:S().required(),email:S().required().matches(he,R("email_error"))})},{handleSubmit:H,resetForm:O}=ne(k.value?r:b),X=()=>{try{const e=new FormData;e.append("content",s.value.message),s.value.attachments.forEach((n,_)=>{e.append(`attachments[${_}]`,n)}),I(h.ticketId,e),O(),a()}catch(e){console.log(e)}},Y=()=>{c.push(y(E.contact_us))},Z=H(async()=>{try{const e=new FormData;if(e.append("title",s.value.subject),e.append("content",s.value.message),s.value.attachments.forEach((n,_)=>{e.append(`attachments[${_}]`,n)}),k.value||(e.append("reply_name",s.value.name),e.append("reply_mail",s.value.email)),k.value){const{data:n}=await w(e);c.push({path:y(`${E.contact_us}/${n.ticket_id}`),query:{new:"true"}})}else await L(e),K.value=!0;v.value={},a()}catch(e){console.log(e),e&&typeof e=="object"?v.value=e:v.value={msg:e}}finally{O()}}),J=e=>{var V;let n=0;const _=(V=e.target)==null?void 0:V.files;if(_)for(let q=0;q<_.length;q++){const g=_[q];n+=g.size,ce.test(g.type)&&(g.src=URL.createObjectURL(g),g.onload=function(){URL.revokeObjectURL(g.src)})}n>re||(_&&(s.value.attachments=[...s.value.attachments,...Array.from(_)]),e.target.value="")},Q=e=>{s.value.attachments=s.value.attachments.filter(n=>n.name!==e.name)};return(e,n)=>{const _=le,V=ie,q=Ee,g=Re,N=ke,B=ve,ee=$e,te=we,ae=be;return t(K)?(o(),d("div",Pe,[u(N,{name:"support",width:48,height:48,class:"tw-mb-5 tw-text-input-fg"}),m("h2",Ge,f(e.$t("thanks_in_advance")),1),m("p",We,f(e.$t("we_appreciate_you")),1),m("p",He,f(e.$t("while_we_do_our_best")),1),u(ae,{to:t(y)(t(E).main_home),class:"guest-success-btn"},{default:A(()=>[u(B,{"label-key":"close"})]),_:1},8,["to"])])):(o(),d("form",{key:0,class:D(["ticket-create-form",{"single-ticket-form":!T}])},[Object.keys(t(v)).length?(o(),$(_,{key:0,error:t(v),type:"content",class:"tw-mb-4"},null,8,["error"])):p("",!0),t(k)?p("",!0):(o(),$(V,{key:1,modelValue:t(s).name,"onUpdate:modelValue":n[0]||(n[0]=i=>t(s).name=i),class:"tw-mb-3","is-required":"","placeholder-text":e.$t("name"),"input-name":"name","is-validated-separately":!1},null,8,["modelValue","placeholder-text"])),t(k)?p("",!0):(o(),$(V,{key:2,modelValue:t(s).email,"onUpdate:modelValue":n[1]||(n[1]=i=>t(s).email=i),"is-required":"",class:"tw-mb-3","is-requried":!0,"placeholder-text":e.$t("email"),"input-name":"email","is-validated-separately":!1},null,8,["modelValue","placeholder-text"])),e.ticketId?p("",!0):(o(),$(V,{key:3,modelValue:t(s).subject,"onUpdate:modelValue":n[2]||(n[2]=i=>t(s).subject=i),"is-validated-separately":!1,"is-required":"","placeholder-text":e.$t("subject"),"input-name":"subject",class:"tw-mb-3"},null,8,["modelValue","placeholder-text"])),u(q,{modelValue:t(s).message,"onUpdate:modelValue":n[3]||(n[3]=i=>t(s).message=i),class:"tw-h-40 tw-mb-3","placeholder-key":"message","input-name":"message","is-validated-separately":!1},null,8,["modelValue"]),m("div",Ue,[m("div",Ae,[m("div",De,[u(g,{class:"form-file-input","is-multiple":!0,"input-name":"files",onInput:J}),u(B,{"label-key":"add_files_up_to_8_mb","color-type":"secondary",class:"form-file-button","icon-position":"left","is-with-icon":""},{default:A(()=>[u(N,{name:"clip",class:"tw-text-text-secondary",width:25,height:25})]),_:1})]),m("div",xe,f(e.$t("you_can_choose_several")),1)]),e.ticketId?(o(),$(B,{key:0,"label-key":"send","color-type":"primary",class:"form-reply-ticket",onClick:X})):p("",!0)]),t(s).attachments.length?(o(),d("div",Me,[(o(!0),d(ye,null,ge(t(s).attachments,i=>(o(),d("div",{key:i.name,class:"ticket-create-form-file"},[u(ee,{class:"delete-button","label-key":"delete","color-type":"red",onClick:Qe=>Q(i)},{default:A(()=>[u(N,{name:"contact-us-remove-file",color:"white",width:15,height:15})]),_:2},1032,["onClick"]),i.src?(o(),$(te,{key:0,alt:i.name,width:"60",height:"60",src:i.src},null,8,["alt","src"])):(o(),$(N,{key:1,name:"contact-us-file",color:"#63657F",width:60,height:60})),m("div",Oe,f(i.name),1)]))),128))])):p("",!0),e.ticketId?p("",!0):(o(),d("div",ze,[u(B,{"label-key":"back","color-type":"secondary",onClick:Y}),u(B,{"label-key":"submit_ticket","color-type":"primary",onClick:t(Z)},null,8,["onClick"])]))],2))}}}),Ye=Ie(Xe,[["__scopeId","data-v-3e31a72c"]]),Ze={class:"ticket-create"},Je=x({__name:"create",setup(C){const R=G(),{t:c}=M(),{setBreadcrumbs:l}=Te(),{isLoggedIn:y}=W(R),h=()=>{y.value?l([{label:c("support"),path:"/tickets"},{label:c("create_ticket")}]):l([])};return Ve(async()=>{await h()},{watch:[y]},"$8tCr9VWMzi"),ue(),Se({title:"Create ticket"}),(w,L)=>{const I=se,F=Ye;return o(),d("div",Ze,[u(I,{"title-key":"create_ticket","icon-name":"contact-us"}),u(F)])}}}),nt=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"}));export{Ye as _,nt as c};
