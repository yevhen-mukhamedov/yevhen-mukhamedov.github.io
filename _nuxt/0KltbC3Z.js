import{_ as gt}from"./Bxl7epld.js";import{b as yt,_ as wt,C as et,c as bt,M as vt}from"./BrvGPcun.js";import{_ as W}from"./sQNTZNBq.js";import{u as Ct,f as ct}from"./R1J_LkVd.js";import{b3 as dt,V as J,_ as Q,a2 as ot,a1 as G,j as F,o as m,c as P,a as e,t as f,X as t,b as S,u as d,ah as ut,ai as pt,a6 as X,f as T,x as O,T as st,bp as nt,ab as mt,a0 as lt,i as h,N as $t,K as St,bm as _t,aA as xt,ac as Mt,ae as q,k as Nt,a5 as kt,F as Ot,n as Vt,z as Tt}from"./JoFQSik9.js";import{_ as It}from"./1-N0yLDQ.js";import{_ as Lt}from"./ChQlXKMR.js";import{_ as at}from"./Bcnv4IFf.js";import{u as Pt}from"./PP6ET3BF.js";import{u as rt}from"./CXetEtI4.js";import{_ as Bt}from"./B92FZ1g3.js";import{c as Y,_ as Et}from"./RGGkZJYr.js";import{_ as Dt}from"./BKAhWZth.js";import{_ as Ut}from"./BMBJnSAB.js";import{a as Rt}from"./BM2BYuY2.js";import"./ClZaf3ID.js";import"./D8aEg3BZ.js";import"./DTX8-FfK.js";import"./DdIClELx.js";import"./Cel6GgYv.js";import"./56Y_7FHu.js";import"./Cf_ozb67.js";const zt=dt("/img/GEM.png"),At=r=>(ut("data-v-822a91d7"),r=r(),pt(),r),qt={class:"shop-card"},Ft={class:"shop-card-img-wrapper"},Gt=["src","alt"],Ht={class:"shop-card-info"},jt={class:"tw-flex tw-items-center tw-justify-between tw-mt-auto"},Kt={class:"tw-flex tw-items-center"},Wt=At(()=>e("img",{src:zt,alt:"gem"},null,-1)),Xt={class:"tw-flex tw-flex-col tw-ml-2"},Yt={key:0,class:"shop-card-price"},Jt={class:"fg-title-16-bold"},Qt=J({__name:"CardShop",props:{product:{}},emits:["openModal"],setup(r,{emit:y}){const{platformCommasFormat:w}=Ct(),u=["0f0b84f4-bf49-417e-bf4d-4fad0cbcb289","8213223e-e1e4-4e0b-8046-03b7a6b1ede7"],C=y,B=r,{t:I}=Q(),L=ot(),{isLoggedIn:p}=G(L),E=F(()=>p.value?I("buy_now"):I("join_now")),V=()=>{C("openModal",B.product)};return($,U)=>{const M=W;return m(),P("div",qt,[e("div",Ft,[e("img",{src:$.product.banner,alt:`shop-card ${$.product.name}`,class:"img",onClick:V},null,8,Gt)]),e("div",Ht,[e("h3",{class:"shop-card-title fg-text-14-fat",onClick:V},f($.product.name),1),e("div",jt,[e("div",Kt,[Wt,e("p",Xt,[$.product.discount?(m(),P("span",Yt,f(t(w)(u,$.product.price,".",!0)),1)):S("",!0),e("span",Jt,f(t(w)(u,$.product.total,".",!0)),1)])]),d(M,{"label-key":t(E),onClick:V},null,8,["label-key"])])])])}}}),Zt=X(Qt,[["__scopeId","data-v-822a91d7"]]),te=dt("/img/successful.png"),ee={},oe=r=>(ut("data-v-2d86a423"),r=r(),pt(),r),se={class:"tw-font-bold"},ne={class:"success-block"},le=oe(()=>e("img",{src:te,alt:"successful",class:"tw-mb-6 tw-mt-4"},null,-1)),ae={class:"tw-text-lg tw-font-bold"};function ce(r,y){const w=W,u=at;return m(),T(st,{to:"#globalModal"},[d(u,{class:"buy-modal success","fullscreen-mode":"","modal-max-width":"512px",onClose:y[1]||(y[1]=C=>r.$emit("close"))},{title:O(()=>[e("h2",se,f(r.$t("success")),1)]),content:O(()=>[e("div",ne,[le,e("p",ae,f(r.$t("purchase_was_successful")),1),d(w,{"label-key":r.$t("continue_shopping"),"color-type":"primary",class:"tw-mt-6 tw-w-full",onClick:y[0]||(y[0]=C=>r.$emit("close"))},null,8,["label-key"])])]),_:1})])}const re=X(ee,[["render",ce],["__scopeId","data-v-2d86a423"]]),it=""+new URL("gem.BxDKkVpv.svg",import.meta.url).href,ie={class:"shop-modal-img-wrapper"},de=["src","alt"],ue={class:"shop-modal-info"},pe={class:"shop-modal-title fg-title-20-thin"},me=["innerHTML"],_e={key:0,class:"shop-modal-prices"},he={class:"shop-modal-prices_text fg-text-12-thin"},fe={class:"shop-modal-tiers fg-text-12-fat"},ge={class:"tw-text-center tw-text-text-tertiary tw-font-bold"},ye={class:"tw-flex tw-items-center tw-text-base tw-font-bold mobileLarge:tw-text-sm"},we=["src"],be={class:"ng-modal-footer"},ve={class:"tw-flex tw-items-center"},Ce=["src"],$e={class:"tw-flex tw-flex-col"},Se={key:0,class:"shop-modal-price fg-text-12-fat"},xe={class:"tw-text-xl tw-font-bold tw-leading-6"},Me=4,Ne=J({__name:"ProductModal",props:{id:{}},emits:["close","open-buy-modal","success"],setup(r,{emit:y}){const w=r,u=y,C=ot(),B=nt(),I=mt(),L=lt(),{t:p}=Q(),{shiftOpenedModals:E}=L,{fetchProduct:V,submitOrder:$}=B,{getTiers:U,fetchSettings:M,fetchData:x}=I,{isLoggedIn:N}=G(C),i=h(null),g=h([]),a=F(()=>N.value?p("buy_now"):p("join_now")),k=F(()=>{var _,l;return((_=i.value)==null?void 0:_.is_bonus)||((l=i.value)==null?void 0:l.type)===Me}),b=F(()=>{var _;return Number(U.points??0)<Number((_=i.value)==null?void 0:_.price)}),H=async()=>{const _=await V(w.id);i.value=_.product,g.value=_.prices},R=()=>{E(),u("close")},z=()=>{k.value?j():(u("open-buy-modal",i.value),R())},j=async()=>{try{await $({id:w.id}),M(),x(),R(),u("success")}catch(_){const{error_code:l,latestDate:n=null}=_;l===_t.BONUS_CANNOT_BE_CLOSED&&n&&u("close")}};return $t(()=>{H()}),(_,l)=>{const n=W,v=at;return m(),T(st,{to:"#globalModal"},[t(i)?(m(),T(v,{key:0,"modal-max-width":"512px","close-icon-size":"10","without-bg":"","fullscreen-mode":"",class:"shop-modal",onClose:l[0]||(l[0]=o=>u("close"))},{title:O(()=>[e("div",ie,[e("img",{src:t(i).banner,alt:`shop-modal ${t(i).name}`,class:"img"},null,8,de)])]),content:O(()=>[e("div",ue,[e("h3",pe,f(t(i).name),1),e("p",{class:"shop-modal-desc fg-text-14-thin",innerHTML:t(i).description},null,8,me),t(g).length?(m(),P("div",_e,[e("p",he,f(t(p)("play_more")),1),e("div",fe,[e("p",ge,f(t(g)[0].tier_name),1),e("p",ye,[e("img",{src:t(it),alt:"gem",width:"16",height:"16",class:"tw-mr-1"},null,8,we),St(" "+f(t(g)[0].total),1)])])])):S("",!0)]),e("div",be,[e("div",ve,[e("img",{src:t(it),alt:"gem",width:"24",height:"24",class:"tw-mr-1"},null,8,Ce),e("p",$e,[t(i).discount?(m(),P("span",Se,f(t(ct)(t(i).price)),1)):S("",!0),e("span",xe,f(t(ct)(t(i).total)),1)])]),d(n,{"is-disabled":t(b),"label-key":t(a),class:"submit-btn",onClick:z},null,8,["is-disabled","label-key"])])]),_:1})):S("",!0)])}}}),ke=X(Ne,[["__scopeId","data-v-2a032957"]]),Oe={class:"tw-font-bold"},Ve={class:"tw-flex tw-flex-col tw-gap-4 tw-p-4 tw-h-full"},Te={class:"tw-flex tw-items-center slot-option"},Ie={class:"tw-flex"},Le={class:"tw-ml-2"},Pe={class:"country-label fg-text-14-thin"},Be={class:"country-name fg-text-14-thin"},Ee={class:"tw-flex tw-items-center"},De={class:"tw-ml-2"},Ue={class:"country-name fg-text-14-thin"},Re={class:"tw-flex tw-justify-center tw-mt-auto"},ze=J({__name:"ProductBuyModal",props:{product:{}},emits:["close","success"],setup(r,{emit:y}){const{product:w}=r,u=y,C=mt(),B=lt(),I=nt(),L=xt(),{t:p}=Q(),{submitOrder:E}=I,{fetchProfile:V}=L,{fetchSettings:$,fetchData:U}=C,{handleSubmit:M}=Rt({validationSchema:Mt({full_name:q().required(),country:q().required(),phone:q().min(6).max(16).required(),city:q().required(),street:q().required(),zip_code:q().required()})}),{getCountryCode:x}=G(B),{getProfileInfo:N}=G(L),i=new Map(Y.map(l=>[l.iso2,l])),g=h(null),a=h({full_name:"",country:"",phone:"",city:"",street:"",zip_code:""}),k=h(""),b=h({}),H=F(()=>w.is_bonus||w.type===4),R=F(()=>H.value?p("product_with_out_order_heading"):p("shipping_address")),z=()=>{var l,n,v;if((n=(l=N.value)==null?void 0:l.country_code)!=null&&n.length)Y.forEach(o=>{o.iso2===N.value.country_code&&(k.value=o.phone_code,a.value.country=o.iso2,b.value=o)});else{const o=((v=x.value)==null?void 0:v.toLowerCase())??"",s=i.get(o)??Y[0];k.value=s.phone_code,a.value.country=s.iso2,b.value=s}},j=M(async()=>{var l;g.value=null;try{await E({...a.value,id:w.id}),$(),U(),u("close"),u("success")}catch(n){const{error_code:v,latestDate:o=null}=n,s=(l=n==null?void 0:n.errors)==null?void 0:l.zip_code;s&&(g.value={msg:s[0]}),v===_t.BONUS_CANNOT_BE_CLOSED&&o&&u("close")}}),_=l=>{a.value.phone=`${l.phoneCode}${l.phone}`};return Nt(async()=>{try{await V()}catch(l){console.error(l)}z()}),(l,n)=>{const v=Bt,o=Et,s=kt,D=Dt,K=Ut,Z=W,tt=at;return m(),T(st,{to:"#globalModal"},[d(tt,{class:"buy-modal","fullscreen-mode":"","modal-max-width":"512px",onClose:n[6]||(n[6]=c=>u("close"))},{title:O(()=>[e("h2",Oe,f(t(R)),1)]),content:O(()=>[e("form",Ve,[d(v,{modelValue:t(a).full_name,"onUpdate:modelValue":n[0]||(n[0]=c=>t(a).full_name=c),modelModifiers:{trim:!0},"placeholder-text":t(p)("full_name"),"is-required":!0,"input-name":"full_name"},null,8,["modelValue","placeholder-text"]),d(o,{modelValue:t(a).phone,"onUpdate:modelValue":n[1]||(n[1]=c=>t(a).phone=c),class:"settings-input settings-phone","default-code":t(k),"is-required":!0,"input-name":"phone",onChange:_},null,8,["modelValue","default-code"]),d(D,{modelValue:t(a).country,"onUpdate:modelValue":n[2]||(n[2]=c=>t(a).country=c),"default-option":t(b),"additional-label":l.$t("country"),"displayed-option":"name",placeholder:l.$t("country"),"returned-option":"iso2","item-list":t(Y),"is-required":!0,"input-name":"country","is-search-icon":"","is-searchable":""},{"selected-option":O(({props:c})=>[e("div",Te,[d(s,{"is-init-color":!0,name:c.iso2,size:24,folder:"flags",class:"country-flag"},null,8,["name"]),e("div",Ie,[c.iso2?S("",!0):(m(),T(s,{key:0,color:t(yt)["fg-tertiary"],name:"country",size:20},null,8,["color"])),e("div",Le,[e("p",Pe,f(t(p)("country")),1),e("p",Be,f(c.name),1)])])])]),option:O(({props:c})=>[e("div",Ee,[d(s,{"is-init-color":!0,name:c.iso2,size:24,folder:"flags",class:"country-flag"},null,8,["name"]),e("div",De,[e("p",Ue,f(c.name),1)])])]),_:1},8,["modelValue","default-option","additional-label","placeholder","item-list"]),d(v,{modelValue:t(a).city,"onUpdate:modelValue":n[3]||(n[3]=c=>t(a).city=c),modelModifiers:{trim:!0},"placeholder-text":t(p)("enter_city"),"is-required":!0,"input-name":"city"},null,8,["modelValue","placeholder-text"]),d(v,{modelValue:t(a).street,"onUpdate:modelValue":n[4]||(n[4]=c=>t(a).street=c),modelModifiers:{trim:!0},"placeholder-text":t(p)("enter_details"),"is-required":!0,"input-name":"street"},null,8,["modelValue","placeholder-text"]),d(v,{modelValue:t(a).zip_code,"onUpdate:modelValue":n[5]||(n[5]=c=>t(a).zip_code=c),modelModifiers:{trim:!0},"placeholder-text":t(p)("enter_zip_code"),"is-required":!0,"input-name":"zip_code"},null,8,["modelValue","placeholder-text"]),t(g)?(m(),T(K,{key:0,error:t(g)},null,8,["error"])):S("",!0),e("div",Re,[d(Z,{"label-key":t(p)("submit"),"color-type":"primary",class:"tw-w-full",onClick:t(j)},null,8,["label-key","onClick"])])])]),_:1})])}}}),Ae=X(ze,[["__scopeId","data-v-f7787155"]]),qe={class:"shop"},Fe={key:0,class:"tw-flex tw-flex-col tw-gap-2 tw-mt-4"},Ge={key:0,class:"shop-pagination"},He=12,je=J({__name:"shop",setup(r){const y=ot(),w=nt(),u=lt(),{t:C}=Q(),{setAuthModal:B}=y,{fetchProducts:I,fetchFilters:L}=w,{isLoggedIn:p,tokenChanging:E}=G(y),{isChatOpened:V,isMenuOpened:$}=G(u),U=h(1),M=h(!1),x=h({order:"order",order_dir:"asc",category_ids:[],search:"",limit:He}),N=h([]),i=h(null),g=h([]),a=h(null),k=h(null),b=h(null),H=async()=>{const o={...x.value,"category_ids[]":[...x.value.category_ids].filter(s=>s!==0)};delete o.category_ids;try{const s=await I(o);g.value=s.products,b.value=s.pagination}catch(s){console.error("shopGetDataCallAction pages/shop.vue",s)}},R=async()=>{try{a.value=await L(),j()}catch(o){console.error("shopFiltersCallAction pages/shop.vue",o)}},z=()=>a.value.order_fields.map(o=>({label:C(o.label),data:o.data})),j=()=>{var o,s;if(N.value=[{target:"search",componentName:et.SEARCH_INPUT,props:{classes:"tw-col-span-4",modelValue:"",placeholderText:C("search"),isRequired:!0},mobile:{class:"tw-col-span-6"},leftIcon:{name:"search",size:20}}],(o=a.value)!=null&&o.categories.length){const D=[...a.value.categories];N.value.push({target:"category",componentName:et.MULTI_SELECTOR,props:{modelValue:[0],itemList:D,displayedOption:"name",returnedOption:"id",trackOption:"id",isSearchable:!0,isOptionSearchable:!0,isCloseOnSelected:!1,classList:"categories-list"},mobile:{redirect:!0},counted:{titleKey:"category"},optionsType:bt.TOGGLER_CHECKBOX})}(s=a.value)!=null&&s.order_fields.length&&N.value.push({target:"orders",componentName:et.SINGLE_SELECTOR,props:{modelValue:"",displayedOption:"label",returnedOption:"data",additionalLabel:`${C("sort_by")}:`,defaultOption:z()[0],itemList:z()},mobile:{redirect:!0}})},_=o=>{const s=o.orders,D=o.search?String(o.search):"",K=o.category;x.value={...x.value,category_ids:K,search:D,...s}},l=o=>{p.value?i.value=o.id:B("signUp")},n=o=>{k.value=o},v=()=>{const o=Number(U.value)+1,s=x.value.limit*o;x.value.limit=s};return rt("getShopData",async()=>await H(),{watch:[p,E,x]}),rt("shopFiltersCallAction",async()=>await R()),Pt({title:C("shop")}),(o,s)=>{const D=gt,K=wt,Z=Zt,tt=It,c=W,ht=Lt,ft=re;return m(),P("div",qe,[d(D,{class:"tw-font-bold","icon-name":"shop","title-key":"shop"}),t(N).length?(m(),P("div",Fe,[d(K,{list:t(N),"mobile-settings":{type:("MobileVersionType"in o?o.MobileVersionType:t(vt)).ACCORDION,style:{accordionContainerClass:"shop-filter-accordion"}},"order-settings":{gridCols:6},onChange:_,onInput:_},null,8,["list","mobile-settings"])])):S("",!0),t(g).length?(m(),P(Ot,{key:1},[e("div",{class:Vt([{"shop-list-chat":t(V),"shop-list-menu":t($)},"shop-list"])},[d(tt,{container:!1,list:t(g),"key-name":"shop-list"},{item:O(({item:A})=>[d(Z,{product:A,onOpenModal:l},null,8,["product"])]),_:1},8,["list"])],2),t(b)&&t(g).length?(m(),P("div",Ge,[d(ht,{item:{total:t(b).total,total_pages:t(b).total,page:t(b).per_page},"item-count":t(b).count},Tt({_:2},[t(b).next_page?{name:"action",fn:O(()=>[d(c,{"color-type":"outline","label-key":"show_more",onClick:v})]),key:"0"}:void 0]),1032,["item","item-count"])])):S("",!0)],64)):S("",!0),t(i)?(m(),T(ke,{key:2,id:t(i),onClose:s[0]||(s[0]=A=>i.value=null),onSuccess:s[1]||(s[1]=A=>M.value=!0),onOpenBuyModal:n},null,8,["id"])):S("",!0),t(k)?(m(),T(Ae,{key:3,product:t(k),onClose:s[2]||(s[2]=A=>k.value=null),onSuccess:s[3]||(s[3]=A=>M.value=!0)},null,8,["product"])):S("",!0),t(M)?(m(),T(ft,{key:4,onClose:s[4]||(s[4]=A=>M.value=!1)})):S("",!0)])}}}),fo=X(je,[["__scopeId","data-v-a117cfb4"]]);export{fo as default};
